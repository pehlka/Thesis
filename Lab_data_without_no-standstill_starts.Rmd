---
title: "Lab_data_w/o_no-standstill_starts"
author: "Kayla Pehl"
date: "10/1/2020"
output: html_document
---

# This dataset does NOT include trials where the lizard did not start from a standstill

```{r}
#Importing data and required packages

lab.data <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_final_10.15.20_removed_non-standstill_starts+NAs+negatives.csv")

#Creating new data frame without N/A's in bipedal percent column    
##148 rows in lab.data and 88 rows in lab.data_omit, so 60 trials didn't contain bipedalism but 88 did 
lab.data_omit <- lab.data[!is.na(lab.data$bipedal_percent), ]

fieldspeed_final <- read.csv("~/College of Charleston/Thesis/Data/McElroy Habitat Data/fieldspeed_final.csv")

Racerunner_demographics <- read.csv("~/College of Charleston/Thesis/Data/Racerunner_demographics.csv")
  #demographic data of lizards ran in the lab

library(ggplot2)
library(rcompanion)
library(lme4)
library(sjstats)
library(doBy)
library(car)
library(emmeans)
library(multcompView)
library(nlme)
library(lmtest)
```

```{r}
#Checking to see if all data is in correct formats (i.e. factor vs. numeric)    

is.factor(lab.data$ID)
is.factor(lab.data$sex)
is.factor(lab.data$substrate_type)
is.numeric(lab.data$pauses_side)
is.numeric(lab.data$pauses_top)
is.factor(lab.data$bipedal_quad_side)
is.factor(lab.data$bipedal_quad_top)
is.numeric(lab.data$bipedal_side)
is.numeric(lab.data$bipedal_top)
is.numeric(lab.data$total_video_frames)
is.numeric(lab.data$bipedal_percent)
is.factor(lab.data$no_start_from_standstill)
is.factor(lab.data$stops_before_end_of_racetrack)
is.numeric(lab.data$calibration)
is.numeric(lab.data$side_amax)
is.numeric(lab.data$side_pmax)
is.numeric(lab.data$side_posmax)
is.numeric(lab.data$side_spline_tol)
is.numeric(lab.data$side_tmax)
is.numeric(lab.data$side_vmax)
is.numeric(lab.data$top_amax)
is.numeric(lab.data$top_pmax)
is.numeric(lab.data$top_posmax)
is.numeric(lab.data$top_spline_tol)
is.numeric(lab.data$top_tmax)
is.numeric(lab.data$top_vmax)

#All are correct. Therefore nothing in dataset needs to change.
```


#Getting a feel for the data

```{r}
#Summary of data
summary(lab.data)
```

```{r}
#Number of Pauses
table(lab.data$pauses_side)
table(lab.data$pauses_top)
```

```{r}
#Runs per lizard on each substrate type
table(lab.data$ID, lab.data$substrate_type)

#using this data set (without no-standstill starts), lizard F has no runs for D or s, lizard N has no runs for D, and lizard P has no runs for D; all other lizards have at least 1 run for each of the substrates
```
> should this impact the dataset I use? (not using no-standstill starts currently)?
>> Eric said to do data work up using these 3 lizards and then when I'm done I'll need to go back and run stats without the 3 lizards and then compare the results; if the results are the same, we can run the stats including the 3 lizards, if not, we'll have to decide how to proceed


```{r}
#Females vs males count
table(lab.data$sex)
#70% runs are female, 30% are male
#15 females, 7 males

#7 males, 12 females - in final data set once 3 were removed that didn't have good runs on all 3 substrates
```



> Creating histograms to see distribution of data

#Max acceleration
```{r}
#Side max acceleration per substrate 
ggplot(data = lab.data, aes(side_amax))  + 
  geom_histogram(fill="orange", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Side max acceleration per substrate")

#mean, median & range of side_amax data separated into substrate types
summaryBy(side_amax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Side max acceleration per sex
ggplot(data = lab.data, aes(side_amax))  + 
  geom_histogram(fill="orange", bins = 20, binwidth = 5) +
  facet_wrap(~sex) +
  labs(title = "Side max acceleration per sex")

#mean, median & range of side max acceleration separated into sex
summaryBy(side_amax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max acceleration per substrate 
ggplot(data = lab.data, aes(top_amax))  + 
  geom_histogram(fill="purple", bins = 30, binwidth = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Top max acceleration per substrate")

#mean, median & range of top max acceleration separated into substrate types
summaryBy(top_amax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max acceleration per sex
ggplot(data = lab.data, aes(top_amax))  + 
  geom_histogram(fill="purple", bins = 30, binwidth = 5) +
  facet_wrap(~sex) +
  labs(title = "Top max acceleration per sex")

#mean, median & range of top max acceleration separated into sex
summaryBy(top_amax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```


#Max velocity
```{r}
#Side max velocity per substrate 
ggplot(data = lab.data, aes(side_vmax))  + 
  geom_histogram(fill="orange", bins = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Side max velocity per substrate")

#mean, median & range of side_vmax data separated into substrate types
summaryBy(side_vmax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Side max velocity per sex
ggplot(data = lab.data, aes(side_vmax))  + 
  geom_histogram(fill="orange", bins = 10) +
  facet_wrap(~sex) +
  labs(title = "Side max velocity per sex")

#mean, median & range of side vmax velocity separated into sex
summaryBy(side_vmax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max velocity per substrate 
ggplot(data = lab.data, aes(top_vmax))  + 
  geom_histogram(fill="purple", bins = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Top max velocity per substrate")

#mean, median & range of top max velocity separated into substrate types
summaryBy(top_vmax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max velocity per sex
ggplot(data = lab.data, aes(top_vmax))  + 
  geom_histogram(fill="purple", bins = 10) +
  facet_wrap(~sex) +
  labs(title = "Top max velocity per sex")

#mean, median & range of top max velocity separated into sex
summaryBy(top_vmax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```



#Bipedalism Percentage
```{r}
#Bipedalism percentage per sex Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~sex)

#mean, median & range of bipedal percentage separated into sex
summaryBy(bipedal_percent ~ sex, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#males are bipedal a lot more than females
```

```{r}
#Bipedalism percentage per substrate Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type)

summaryBy(bipedal_percent ~ substrate_type, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#lizards are a lot more likely to run bipedal on debris than sand
```


```{r}
#Bipedalism percentage per substrate and sex Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type + sex) +
  facet_grid(sex ~ substrate_type)

#mean, median & range of bipedal percentage separated into substrate type
summaryBy(bipedal_percent ~ substrate_type + sex, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#males are bipedal more often on every substrate than females

##for final manuscript, change plot titles to actual names instead of letters
### https://www.zevross.com/blog/2019/04/02/easy-multi-panel-plots-in-r-using-facet_wrap-and-facet_grid-from-ggplot2/ 
```


```{r}
#Boxplots of Bipedalism on acceleration 

ggplot(data = lab.data, aes(x=bipedal_quad_side, y=side_amax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max acceleration (side)")

ggplot(data = lab.data, aes(x=bipedal_quad_top, y=top_amax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max acceleration (top)")
```

```{r}
#Boxplots of Bipedalism on velocity

ggplot(data = lab.data, aes(x=bipedal_quad_side, y=side_vmax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max velocity (side)")

ggplot(data = lab.data, aes(x=bipedal_quad_top, y=top_vmax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max velocity (top)")
```


#Pmax, Posmax, Tmax
```{r}
#Histograms of pmax, posmax and tmax
ggplot(data = lab.data, aes(side_pmax)) +
  geom_histogram(fill = "dark blue") +
    labs(title = "Side Pmax")                     #skewed right

ggplot(data = lab.data, aes(side_posmax)) +
  geom_histogram(fill = "dark blue") +
    labs(title = "Side Posmax")                   #skewed left

ggplot(data = lab.data, aes(side_tmax)) +
  geom_histogram(fill = "dark blue") +
    labs(title = "Side Tmax")

ggplot(data = lab.data, aes(top_pmax)) +
  geom_histogram(fill = "medium blue") +
    labs(title = "Top Pmax")                      #skewed right

ggplot(data = lab.data, aes(top_posmax)) +
  geom_histogram(fill = "medium blue") +
    labs(title = "Top Posmax")

ggplot(data = lab.data, aes(top_tmax)) +
  geom_histogram(fill = "medium blue") +
    labs(title = "Top Tmax")                      #skewed right
```

```{r}
#Looking at bipedal vs. quadrupedal percentages from side and top

table(lab.data$bipedal_quad_side)
#42.6% bipedal on side runs, 57.4% quadrupedal on side runs

table(lab.data$bipedal_quad_top)
#53.3% bipedal on top runs, 46.7% quadrupedal on top runs
```


# Checking for normality

```{r}
#Checking for normality of data: max accelerations and velocities

#histograms
ggplot(data = lab.data, aes(side_amax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Side Amax")                        #looks pretty normal

ggplot(data = lab.data, aes(top_amax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Top Amax")                         #looks skewed right

ggplot(data = lab.data, aes(side_vmax))  + 
  geom_histogram(bins = 13, col = ("grey")) +
  labs(title = "Side Vmax")                        #looks fairly normal

ggplot(data = lab.data, aes(top_vmax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Top Vmax")                         #looks skewed left

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(lab.data$side_amax)
shapiro.test((lab.data$top_amax))
shapiro.test((lab.data$side_vmax))
shapiro.test(lab.data$top_vmax)

#side_amax: not normal
#top_amax: not normal
#side_vmax: normal
#top_vmax: normal
```

```{r}
#Checking for normality of data: time and position

#histograms
ggplot(data = lab.data, aes(side_tmax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Side Tmax")                           #looks skewed right

ggplot(data = lab.data, aes(top_tmax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
    labs(title = "Top Tmax")                          #looks skewed right

ggplot(data = lab.data, aes(side_posmax))  + 
  geom_histogram(bins = 13, col = ("grey")) +
    labs(title = "Side Posmax")                       #looks fairly normal

ggplot(data = lab.data, aes(top_posmax))  + 
  geom_histogram(bins = 30, col = ("grey")) +
    labs(title = "Top Posmax")

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(lab.data$side_tmax)
shapiro.test((lab.data$top_tmax))
shapiro.test((lab.data$side_posmax))
shapiro.test(lab.data$top_posmax)

#side_tmax: not normal
#top_tmax: not normal
#side_posmax: normal
#top_posmax: not normal
```

```{r}
#Checking for normality of data: bipedal_side and bipedal_top

#histograms
ggplot(data = lab.data_omit, aes(bipedal_side))  + 
  geom_histogram(bins = 20, col = ("grey"))

ggplot(data = lab.data_omit, aes(bipedal_top))  + 
  geom_histogram(bins = 20, col = ("grey"))

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(lab.data_omit$bipedal_side)
shapiro.test((lab.data_omit$bipedal_top))

#bipedal_side: normal
#bipedal_top: not normal
```



> Looking at diagnostics data

```{r}
#Top max acceleration vs. bipedalism in top

top.amax.biped <- lm(top_amax ~ bipedal_top, data = lab.data)
res.top.amax.biped <- resid(top.amax.biped)
plot(fitted(top.amax.biped), res.top.amax.biped)
abline(0,0)

qqnorm(res.top.amax.biped)
qqline(res.top.amax.biped,
       col = 'red')
plot(density(res.top.amax.biped))

plot(top.amax.biped)

#QQ plot shows data is skewed left -- need to transform
```

```{r}
#Side camera max acceleration vs. bipedalism in side
side.amax.biped <- lm(side_amax ~ bipedal_side, data = lab.data)
res.side.amax.biped <- resid(side.amax.biped)
plot(fitted(side.amax.biped), res.side.amax.biped)

qqnorm(res.side.amax.biped)
qqline(res.side.amax.biped,
       col = 'red')
plot(density(res.side.amax.biped))

plot(side.amax.biped)

#QQ plot maybe slightly skewed left - need to transform
```

```{r}
#Top max velocity vs. bipedalism in top
top.vmax.biped <- lm(top_vmax ~ bipedal_top, data = lab.data)
res.top.vmax.biped <- resid(top.vmax.biped)
plot(fitted(top.vmax.biped), res.top.vmax.biped)

qqnorm(res.top.vmax.biped)
qqline(res.top.vmax.biped,
       col = 'red')
plot(density(res.top.vmax.biped))

plot(top.vmax.biped)

#QQ plot maybe slightly skewed left but it looks pretty close to normal
```

```{r}
#Side max velocity vs. bipedalism in side
side.vmax.biped <- lm(side_vmax ~ bipedal_side, data = lab.data)
res.side.vmax.biped <- resid(side.vmax.biped)
plot(fitted(side.vmax.biped), res.side.vmax.biped)

qqnorm(res.side.vmax.biped)
qqline(res.side.vmax.biped,
       col = 'red')
plot(density(res.side.vmax.biped))

plot(side.vmax.biped)

#QQ plot looks pretty close to normal 
```


#Trying to determine if v_max needs to be transformed or not

```{r}
#Log transform side max velocity vs. bipedalism in side

log_side_vmax <- log(lab.data$side_vmax)
log.side.vmax.biped <- lm(log_side_vmax ~ bipedal_side, data = lab.data)
res.log.side.vmax.biped <- resid(log.side.vmax.biped)
plot(fitted(log.side.vmax.biped), res.log.side.vmax.biped)

shapiro.test(res.log.side.vmax.biped)
hist(log_side_vmax)

qqnorm(res.log.side.vmax.biped)
qqline(res.log.side.vmax.biped,
       col = 'red')
plot(density(res.log.side.vmax.biped))  #QQ plot looks pretty close to normal

plot(log.side.vmax.biped)

ggplot(data = lab.data, aes(log_side_vmax))  + 
  geom_histogram(bins = 13, col = ("grey"))    #skewed left

plot(lm(side_vmax ~ bipedal_side, data = lab.data))  #Side vmax vs. bipedalism

#Q-Q plots of regular and log-transformed side vmax data look basically the same to me. I'm not sure if log-transforming did a lot for the data.
```


```{r}
# Added this section during meeting with Eric

#log transform each variable!
#probably need to log transform all variables and then check residuals
#levene's test

log_side_amax <- log10(lab.data$side_amax+1)
log.side.amax.biped <- lm(log_side_amax ~ bipedal_side, data = lab.data)
res.log.side.amax.biped <- resid(log.side.amax.biped)
plot(fitted(log.side.amax.biped), res.log.side.amax.biped)


shapiro.test(res.log.side.amax.biped)
hist(res.log.side.amax.biped)

leveneTest(log_side_amax, lab.data$bipedal_side)
```

```{r}
#Comparing side vmax data from original with log-transformed

#histograms
plotNormalHistogram(lab.data$side_vmax)  #appears pretty symmetrical 
plotNormalHistogram(log_side_vmax)  #skew left

#Shapiro-Wilks test for normality
shapiro.test(lab.data$side_vmax)  #normal -- not transformed
shapiro.test(log_side_vmax)  #not normal -- log transformed
```

```{r}
#Log transform top max velocity vs. bipedalism in top

log_top_vmax <- log(lab.data$top_vmax)
log.top.vmax.biped <- lm(log_top_vmax ~ bipedal_top, data = lab.data)
res.log.top.vmax.biped <- resid(log.top.vmax.biped)
plot(fitted(log.top.vmax.biped), res.log.top.vmax.biped)  

qqnorm(res.log.top.vmax.biped)
qqline(res.log.top.vmax.biped,
       col = 'red')
plot(density(res.log.top.vmax.biped))  #QQ plot looks pretty close to normal

plot(log.top.vmax.biped)

plot(lm(top_vmax ~ bipedal_top, data = lab.data))  #not transformed  #QQ plot is skewed left
```

```{r}
#Comparing top vmax data from original with log-transformed

#histograms
plotNormalHistogram(lab.data$top_vmax)  #appears pretty symmetrical 
plotNormalHistogram(log_top_vmax)  #skew left

#Shapiro-Wilks test for normality
shapiro.test(lab.data$top_vmax)  #normal -- no transformation
shapiro.test(log_top_vmax)  #not normal  -- log transformed
```



# Linear Models with Interaction Effects

```{r}
#Velocity

anova(lm(top_vmax ~ sex*bipedal_top*substrate_type*ID, data=lab.data))
#sex, bipedal_top & substrate type are all significant by themselves

anova(lm(side_vmax ~ sex*bipedal_side*substrate_type*ID, data = lab.data))
#sex and bipedalism were very significant by themselves
#ID was also significant by itself
```

```{r}
#Acceleration

anova(lm(top_amax ~ sex*bipedal_top*substrate_type*ID, data = lab.data))
#nothing is significant

anova(lm(side_amax ~ sex*bipedal_side*substrate_type*ID, data = lab.data))
#nothing is significant
```


# Bipedal Percentage

```{r}
#Bipedal Percentage Plots

#Histogram of bipedal percent without N/A's broken into sex
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=sex, fill=sex)) +
  geom_histogram(col = "white") + 
  labs(title = "Histogram of Bipedal Percent (without N/As) Broken Down by Sex")

#Histogram of bipedal percent without N/A's separated into substrate type
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type)) +
  geom_histogram(bins = 20, binwidth = 8) +
  facet_wrap(~substrate_type) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Separated by Substrate Type")

#Histogram of bipedal percent without NA's separated into substrate type and sex
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type, alpha=sex)) +
  geom_histogram(bins = 20, binwidth = 8) +
  facet_wrap(~substrate_type) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Separated by Substrate Type and Sex")

#Histogram of bipedal percent without N/A's broken into substrate type
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type)) +
  geom_histogram(bins = 20, binwidth = 8) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Broken into Substrate Type")

#Boxplot of bipedal percent without N/A's separated by substrate type
ggplot(data = lab.data_omit, aes(substrate_type, as.numeric(bipedal_percent))) +
  geom_boxplot() + 
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Substrate Type")

#Boxplot of bipedal percent without N/A's separated by sex
ggplot(data = lab.data_omit, aes(sex, as.numeric(bipedal_percent))) +
  geom_boxplot() + 
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Sex")

#Boxplot of bipedal percent without N/A's separated by substrate type and sex
ggplot(data = lab.data_omit, aes(substrate_type, as.numeric(bipedal_percent), fill = sex)) +
  geom_boxplot() +
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Substrate Type and Sex")


#Lizards are running bipedal the most on debris compared to the other substrate types.
#Based on the boxplot, lizards are treating bipedalism on sand/debris as more similar to sand than debris
#Males run bipedally more frequently than females for all substrate types
```


```{r}
#Percent bipedal vs. substrate types and sex linear models
summary(lm(as.numeric(bipedal_percent) ~ substrate_type*sex, data = lab.data_omit))
anova((lm(as.numeric(bipedal_percent) ~ substrate_type*sex, data = lab.data_omit)))

#Neither substrate type nor sex is significantly effecting bipedalism according to the models
```

```{r}
#looked at with Eric during meeting 10/22

#Mixed model bipedal percent and substrate type
lmer2<-lmer(bipedal_percent ~ substrate_type + (1 | ID), data = lab.data_omit)
lmer3<- lmer(sqrt(bipedal_percent) ~ substrate_type + (1 | ID), data = lab.data_omit)
summary(lmer(bipedal_percent ~ substrate_type + (1 | ID), data = lab.data_omit))
Anova(lmer2)

emmeans(lmer2, pairwise ~ substrate_type, adjust = "tukey", data=lab.data)

hist(residuals(lmer2))
hist(residuals(lmer3))

shapiro.test(residuals(lmer2))  #not normal
shapiro.test(residuals(lmer3))  #need sqrt transform - fixed normality issue   #normal

#sand and sand/debris have significant p-values
```

```{r}
lmer.biped.sub <- lmer(sqrt(bipedal_percent) ~ substrate_type + (1|ID), data = lab.data_omit)
anova(lmer.biped.sub)
plotNormalHistogram(residuals(lmer.biped.sub))   #appears normal
lmer.biped.sub.tukey <- emmeans(lmer.biped.sub, pairwise ~ substrate_type, adjust="tukey", data=lab.data)   
lmer.biped.sub.tukey   #significant differences between D-S but not for D-SD and S-SD
ggplot(data = lab.data_omit, aes(x= substrate_type, y=bipedal_percent)) +
  geom_boxplot() +
  labs(title = "Bipedal Percent by Substrate Type") 
plot(lmer.biped.sub.tukey)
summary(lmer.biped.sub)
performance::r2(lmer.biped.sub)  #low R2s

#can't figure out how to do a Tukey test for lme function so had to use lmer instead
```


```{r}
#Mixed model bipedal percent and sex
lmer(bipedal_percent ~ sex + (1 | ID), data = lab.data_omit)
summary(lmer(bipedal_percent ~ sex + (1 | ID), data = lab.data_omit))
```

```{r}
#Mixed model bipedal percent and substrate type + sex
lmer1<-lmer(bipedal_percent ~ sex*substrate_type + (1 | ID), data = lab.data_omit)
summary(lmer(bipedal_percent ~ sex*substrate_type + (1 | ID), data = lab.data_omit))

#no interaction effects are significant
```

> Levene's test

## Ho: the groups we're comparing all have equal population variances. If this is true, we'll probably find slightly different variances in our samples from these populations. If the sample variances have very different variances then it'll suggest that the population variances weren't equal after all and Ho would have to be rejected.
## Ha: the variance among the groups is not equal
## 2 assumptions: independent observations and the test variable is quantitative
## if p-value is less than significance level (0.05), we can reject Ho and conclude that the variance among the groups is NOT equal
## we want them to not be significant


```{r}
#Levene test - ID
leveneTest(side_amax ~ ID, data = lab_data)   #not significant
leveneTest(top_amax ~ ID, data = lab_data)   #not significant

leveneTest(side_vmax ~ ID, data = lab_data)   #not significant
leveneTest(top_vmax ~ ID, data = lab_data)   #not significant
```

```{r}
#Levene test - sex
leveneTest(side_amax ~ sex, data = lab_data)   #not significant
leveneTest(top_amax ~ sex, data = lab_data)   #not significant

leveneTest(side_vmax ~ sex, data = lab_data)   #not significant
leveneTest(top_vmax ~ sex, data = lab_data)   #not significant
```

```{r}
#Levene test - bipedalism
leveneTest(bipedal_percent ~ substrate_type, data = lab_data)  #not significant so can't reject Ho; variance among groups may be equal
leveneTest(bipedal_side ~ substrate_type, data = lab_data)   #not significant
leveneTest(bipedal_top ~ substrate_type, data = lab_data)   #not significant
```




> Checking assumptions: normality of residuals
## all residuals should be log transformed

```{r}
#Log transforming all variables 
##included log10 and +1 because it forces 0's to be 0's and not something else

log_side_amax <- log10(lab.data$side_amax +1)
log_top_amax <- log10(lab.data$top_amax +1)
log_side_vmax <- log10(lab.data$side_vmax +1)
log_top_vmax <- log10(lab.data$top_vmax +1)
log_side_posmax <- log10(lab.data$side_posmax +1)
log_top_posmax <- log10(lab.data$top_posmax +1)
log_side_tmax <- log10(lab.data$side_tmax +1)
log_top_tmax <- log10(lab.data$top_tmax +1)
log_side_pmax <- log10(lab.data$side_pmax +1)
log_top_pmax <- log10(lab.data$top_pmax +1)

log_bipedal_side <- log10(lab.data$bipedal_side +1)
log_bipedal_top <- log10(lab.data$bipedal_top +1)
log_bipedal_percent <- log10(lab.data$bipedal_percent +1)
```


#Writing linear models and Residuals

```{r}
#log.side.amax.biped
log.side.amax.biped <- lm(log_side_amax ~ log_bipedal_side, data = lab.data)
res.log.side.amax.biped <- resid(log.side.amax.biped)
plot(fitted(log.side.amax.biped), res.log.side.amax.biped)

qqnorm(res.log.side.amax.biped)
qqline(res.log.side.amax.biped,
       col = 'red')
shapiro.test(res.log.side.amax.biped)  #normal
plotNormalHistogram(res.log.side.amax.biped)

#log transforming bipedal_side did not appear to change ANYTHING, so I'm just going to run all other runs using log_bipedal

#lmer model
lmer.log.side.amax.biped <- lmer(log_side_amax ~ log_bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.amax.biped)
```


```{r} 
#log.top.amax.biped
log.top.amax.biped <- lm(log_top_amax ~ log_bipedal_top, data = lab.data)
res.log.top.amax.biped <- resid(log.top.amax.biped)

plot(fitted(log.top.amax.biped), res.log.top.amax.biped)
qqnorm(res.log.top.amax.biped)
qqline(res.log.top.amax.biped,
       col = 'red')
shapiro.test(res.log.top.amax.biped)  #normal
plotNormalHistogram(res.log.top.amax.biped)

#lmer model
lmer.log.top.amax.biped <- lmer(log_top_amax ~ log_bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.amax.biped)
```

```{r}
#log.side.vmax.biped
log.side.vmax.biped <- lm(log_side_vmax ~ bipedal_side, data = lab.data)
res.log.side.vmax.biped <- resid(log.side.vmax.biped)

plot(fitted(log.side.vmax.biped), res.log.side.vmax.biped)
qqnorm(res.log.side.vmax.biped)
qqline(res.log.side.vmax.biped,
       col = 'red')
shapiro.test(res.log.side.vmax.biped)  #normal
plotNormalHistogram(res.log.side.vmax.biped)

#lmer model
lmer.log.side.vmax.biped <- lmer(log_side_vmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.vmax.biped)
```

```{r}
#log.top.vmax.biped
log.top.vmax.biped <- lm(log_top_vmax ~ bipedal_top, data = lab.data)
res.log.top.vmax.biped <- resid(log.top.vmax.biped)

plot(fitted(log.top.vmax.biped), res.log.top.vmax.biped)
qqnorm(res.log.top.vmax.biped)
qqline(res.log.top.vmax.biped,
       col = 'red')
shapiro.test(res.log.top.vmax.biped)  #normal
plotNormalHistogram(res.log.top.vmax.biped)

#lmer model
lmer.log.top.vmax.biped <- lmer(log_top_vmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.vmax.biped)
```

```{r}
#log.side.posmax.biped
log.side.posmax.biped <- lm(log_side_posmax ~ bipedal_side, data = lab.data)
res.log.side.posmax.biped <- resid(log.side.posmax.biped)

plot(fitted(log.side.posmax.biped), res.log.side.posmax.biped)
qqnorm(res.log.side.posmax.biped)
qqline(res.log.side.posmax.biped,
       col = 'red')
shapiro.test(res.log.side.posmax.biped)  #normal
plotNormalHistogram(res.log.side.posmax.biped)

#lmer model
lmer.log.side.posmax.biped <- lmer(log_side_posmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.posmax.biped)
```

```{r}
#log.top.posmax.biped
log.top.posmax.biped <- lm(log_top_posmax ~ bipedal_top, data = lab.data)
res.log.top.posmax.biped <- resid(log.top.posmax.biped)

plot(fitted(log.top.posmax.biped), res.log.top.posmax.biped)
qqnorm(res.log.top.posmax.biped)
qqline(res.log.top.posmax.biped,
       col = 'red')
shapiro.test(res.log.top.posmax.biped)  #not normal - skewed right   #really weird data
plotNormalHistogram(res.log.top.posmax.biped)

#lmer model
lmer.log.top.posmax.biped <- lmer(log_top_posmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.posmax.biped)
```

```{r}
#log.side.tmax.biped
log.side.tmax.biped <- lm(log_side_tmax ~ bipedal_side, data = lab.data)
res.log.side.tmax.biped <- resid(log.side.tmax.biped)

plot(fitted(log.side.tmax.biped), res.log.side.tmax.biped)
qqnorm(res.log.side.tmax.biped)
qqline(res.log.side.tmax.biped,
       col = 'red')
shapiro.test(res.log.side.tmax.biped)  #not normal - skewed right
plotNormalHistogram(res.log.side.tmax.biped)

#lmer model
lmer.log.side.tmax.biped <- lmer(log_side_tmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.tmax.biped)
```

```{r}
#log.top.tmax.biped
log.top.tmax.biped <- lm(log_top_tmax ~ bipedal_top, data = lab.data)
res.log.top.tmax.biped <- resid(log.top.tmax.biped)

plot(fitted(log.top.tmax.biped), res.log.top.tmax.biped)
qqnorm(res.log.top.tmax.biped)
qqline(res.log.top.tmax.biped,
       col = 'red')
shapiro.test(res.log.top.tmax.biped)  #not normal - skewed right
plotNormalHistogram(res.log.top.tmax.biped)

#lmer model
lmer.log.top.tmax.biped <- lmer(log_top_tmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.tmax.biped)
```

```{r}
#log.side.pmax.biped
log.side.pmax.biped <- lm(log_side_pmax ~ bipedal_side, data = lab.data)
res.log.side.pmax.biped <- resid(log.side.pmax.biped)

plot(fitted(log.side.pmax.biped), res.log.side.pmax.biped)
qqnorm(res.log.side.pmax.biped)
qqline(res.log.side.pmax.biped,
       col = 'red')
shapiro.test(res.log.side.pmax.biped)  #normal 
plotNormalHistogram(res.log.side.pmax.biped)

#lmer model
lmer.log.side.pmax.biped <- lmer(log_side_pmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.pmax.biped)
```

```{r}
#log.top.pmax.biped
log.top.pmax.biped <- lm(log_top_pmax ~ bipedal_top, data = lab.data)
res.log.top.pmax.biped <- resid(log.top.pmax.biped)

plot(fitted(log.top.pmax.biped), res.log.top.pmax.biped)
qqnorm(res.log.top.pmax.biped)
qqline(res.log.top.pmax.biped,
       col = 'red')
shapiro.test(res.log.top.pmax.biped)  #normal
plotNormalHistogram(res.log.top.pmax.biped)

#lmer model
lmer.log.top.pmax.biped <- lmer(log_top_pmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.pmax.biped)
```



> Glmer and lmer

## lmer is used to fit linear mixed-effect models, so it assumes that the residual error has a Gaussian distribution. If your dependent variable A is a binary outcome (e.g. a yes/no response), then the error distribution is binomial and not Gaussian. In this case you have to use glmer, which allow to fit a generalized linear mixed-effects model: these models include a link function that allows to predict response variables with non-Gaussian distributions.
## glmer -> use when dependent variable (X) is a binary outcome (e.g. yes/no)
### 1 refers to an intercept; means 'add a random intercept for each ID level'


#Lmer models with v/a/biped/p/t vs. substrate type -- Question 2

#larger F-values represent greater dispersion of data

```{r}
#Velocity - Side
lmer.log.side.vmax.sub <- lmer(log_side_vmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.vmax.sub)
summary(lmer.log.side.vmax.sub)
shapiro.test(residuals(lmer.log.side.vmax.sub))  #normal
lmer.log.side.vmax.sub.tukey <- emmeans(lmer.log.side.vmax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab.data)   
lmer.log.side.vmax.sub.tukey   
ggplot(data = lab.data, aes(x= substrate_type, y=log_side_vmax)) +
  geom_boxplot() +
  labs(title = "Side Velocity by Substrate Type") 
summary(lmer.log.side.vmax.sub)
performance::r2(lmer.log.side.vmax.sub)  #low R2s
```

```{r}
#Velocity - Top
lmer.log.top.vmax.sub <- lmer(log_top_vmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.vmax.sub)  
shapiro.test(residuals(lmer.log.top.vmax.sub))  #NOT normal
lmer.log.top.vmax.sub.tukey <- emmeans(lmer.log.top.vmax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab.data)   
lmer.log.top.vmax.sub.tukey   
ggplot(data = lab.data, aes(x= substrate_type, y=log_top_vmax)) +
  geom_boxplot() +
  labs(title = "top Velocity by Substrate Type") 
summary(lmer.log.top.vmax.sub)
performance::r2(lmer.log.top.vmax.sub)  #low R2s
#DATA NOT NORMAL - TRANSFORM
```

```{r}
#Acceleration
lmer.log.side.amax.sub <- lmer(log_side_amax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.amax.sub)  
anova(lmer.log.side.amax.sub)  
shapiro.test(residuals(lmer.log.side.amax.sub))   #normal
lmer.log.side.amax.sub.tukey <- emmeans(lmer.log.side.amax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab.data)   
lmer.log.side.amax.sub.tukey   
ggplot(data = lab.data, aes(x= substrate_type, y=log_side_amax)) +
  geom_boxplot() +
  labs(title = "Side Acceleration by Substrate Type") 
summary(lmer.log.side.amax.sub)
performance::r2(lmer.log.side.amax.sub)  #low R2s

lmer.log.top.amax.sub <- lmer(log_top_amax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.amax.sub)  
```  

```{r}
#Bipedalism
lmer.log.side.bipedal.sub <- lmer(log_bipedal_side ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.bipedal.sub)  

lmer.log.top.bipedal.sub <- lmer(log_bipedal_top ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.bipedal.sub)  
```

```{r}
#Power
lmer.log.side.pmax.sub <- lmer(log_side_pmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.pmax.sub)   

lmer.log.top.pmax.sub <- lmer(log_top_pmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.pmax.sub)   
```

```{r}
#Time
lmer.log.side.tmax.sub <- lmer(log_side_tmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.tmax.sub) 

lmer.log.top.tmax.sub <- lmer(log_top_pmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.tmax.sub)  
```


```{r}
#Velocity - sex
lmer.log.side.vmax.sex <- lmer(log_side_vmax ~ sex + (1 | ID), data = lab.data)
anova(lmer.log.side.vmax.sex)  

lmer.log.top.vmax.sex <- lmer(log_top_vmax ~ sex + (1 | ID), data = lab.data)
anova(lmer.log.top.vmax.sex)  
```




> Tukey Test

## don't need to do with sex because it's only 2 groups and because sex doesn't play a big role in overall analysis

```{r}
#Substrate

tukey.lmer.log.side.amax.sub <- emmeans(lmer.log.side.amax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab.data)
tukey.lmer.log.side.amax.sub
plot(tukey.lmer.log.side.amax.sub)
ggplot(data = lab.data, aes(y=side_amax, x=substrate_type)) +
  geom_boxplot()
#p-value is significant for D-S but not for D-SD and S-SD

tukey.lmer.log.top.amax.sub <- emmeans(lmer.log.top.amax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab.data)
tukey.lmer.log.top.amax.sub
plot(tukey.lmer.log.top.amax.sub)
ggplot(data = lab.data, aes(y=top_amax, x=substrate_type)) +
  geom_boxplot()
#p-value significant for D-S and D-S but not for S-SD

tukey.lmer.log.side.vmax.sub <- emmeans(lmer.log.side.vmax.sub, pairwise ~ substrate_type, adjust = "tukey", data=lab.data)
tukey.lmer.log.side.vmax.sub
plot(tukey.lmer.log.side.vmax.sub)
ggplot(data = lab.data, aes(y=side_vmax, x=substrate_type)) +
  geom_boxplot()
#p-value significant between D-S but not between D-SD and S-SD

tukey.lmer.log.top.vmax.sub <- emmeans(lmer.log.top.vmax.sub, pairwise ~ substrate_type, adjust = "tukey", data=lab.data)
tukey.lmer.log.top.vmax.sub
plot(tukey.lmer.log.top.vmax.sub)
ggplot(data = lab.data, aes(y=top_vmax, x=substrate_type)) +
  geom_boxplot()
#p-value significant between D-S and D-SD but not between S-SD
```



> Bipedalism and Velocity/Acceleration

```{r}
#Bipedalism's effect on side velocity
biped.side.vmax <- lme(log10(bipedal_percent+1) ~ log10(side_vmax+1), random = ~1|ID, data = lab.data_omit)
anova(biped.side.vmax)   #p-value < 0.0001   #significant
hist(residuals(biped.side.vmax))
shapiro.test(residuals(biped.side.vmax))  #normal
summary(biped.side.vmax)
performance::r2(biped.side.vmax)   #low R2s

#velocity does affect bipedalism in side videos 
```

```{r}
vmax.biped.side <- lme(log10(side_vmax+1) ~ log10(bipedal_percent+1), random = ~1|ID, data=lab.data_omit)
anova(vmax.biped.side)   #p-value < 0.0001   #significant
hist(residuals(vmax.biped.side))
shapiro.test(residuals(vmax.biped.side))   #normal
summary(vmax.biped.side)
performance::r2(vmax.biped.side)   #low R2s

#bipedalism does affect velocity in side videos
```

```{r}
#Bipedalism's effect on top velocity
biped.top.vmax <- lme(log10(bipedal_percent+1) ~ log10(top_vmax+1), random = ~1|ID, data = lab.data_omit)
anova(biped.top.vmax)   #p-value = 0.0165   #significant
hist(residuals(biped.top.vmax))
shapiro.test(residuals(biped.top.vmax))   #normal
summary(biped.top.vmax)
performance::r2(biped.top.vmax)   #low R2s

#velocity does affect bipedalism in top videos
```

```{r}
vmax.biped.top <- lme(log10(top_vmax+1) ~ log10(bipedal_percent+1), random = ~1|ID, data=lab.data_omit)
anova(vmax.biped.top)   #p-value = 0.0153   #significant
hist(residuals(vmax.biped.top))
shapiro.test(residuals(vmax.biped.top))   #normal
summary(vmax.biped.top)
performance::r2(vmax.biped.top)   #low R2s

#bipedalism does affect velocity in top videos
```


```{r}
#Bipedalism's effect on side acceleration
biped.side.amax <- lme(log10(bipedal_percent+1) ~ log10(side_amax+1), random = ~1|ID, data = lab.data_omit)
anova(biped.side.amax)   #p-value = 0.9311   #not significant
hist(residuals(biped.side.amax))
shapiro.test(residuals(biped.side.amax))  #normal
summary(biped.side.amax)
performance::r2(biped.side.amax)   #low R2s

#acceleration does not affect bipedalism in side videos 
```

```{r}
amax.biped.side <- lme(log10(side_amax+1) ~ log10(bipedal_percent+1), random = ~1|ID, data=lab.data_omit)
anova(amax.biped.side)   #p-value = 0.6629   #not significant
hist(residuals(amax.biped.side))
shapiro.test(residuals(amax.biped.side))   #normal
summary(amax.biped.side)
performance::r2(amax.biped.side)   #low R2s

#bipedalism does not affect acceleration in side videos
```


```{r}
#Bipedalism's effect on top acceleration
biped.top.amax <- lme(log10(bipedal_percent+1) ~ log10(top_amax+1), random = ~1|ID, data = lab.data_omit)
anova(biped.top.amax)   #p-value = 0.0081   #significant
hist(residuals(biped.top.amax))
shapiro.test(residuals(biped.top.amax))   #normal
summary(biped.top.amax)
performance::r2(biped.top.amax)   #low R2s

#acceleration does affect bipedalism in top videos, but lizard's aren't starting from a standstill so this may be inaccurate
```



> Pauses

```{r}
side.amax.pause <- lme(log_side_amax ~ pauses_side == "0", random = ~1|ID, data = lab.data)
anova(side.amax.pause)   #p-value = 0.2037  #not signficant
hist(residuals(side.amax.pause))
shapiro.test(residuals(side.amax.pause))   #normal
summary(side.amax.pause)
performance::r2(side.amax.pause)   #low R2s

#pauses do not affect acceleration in side videos
```

```{r}
side.amax.pause <- lme(log_side_amax ~ pauses_side, random = ~1|ID, data = lab.data)
anova(side.amax.pause)   #p-value = 0.2341  #not signficant
hist(residuals(side.amax.pause))
shapiro.test(residuals(side.amax.pause))   #normal
summary(side.amax.pause)
performance::r2(side.amax.pause)   #low R2s
```

```{r}
top.amax.pause <- lme(log_top_amax ~ pauses_side)
```

```{r}
lab.data_pause <- lab.data[!is.na(lab.data$pauses_side), ]
```

```{r}
lab.data_side_pause_0 <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_final_10.23.20_removed_non-standstill_starts+NAs+negatives_side_pause_0.csv")

lab.data_side_pause_1 <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_final_10.15.20_removed_non-standstill_starts+NAs+negatives_side_pause_1+.csv")
```

```{r}
#Pauses effect on side acceleration - 0 pauses
lmer.side.amax.pause0 <- lmer(log10(side_amax+1) ~ pauses_side + (1|ID), data = lab.data_side_pause_0)
summary(lmer.side.amax.pause0)
anova(lmer.side.amax.pause0)   
tukey.lmer.side.amax.pause0 <- emmeans(lmer.side.amax.pause0, pairwise ~ pauses_side, adjust="tukey", data=lab.data_side_pause_0)
tukey.lmer.side.amax.pause0

#not sure what this is saying
```

```{r}
#Pauses effect on side acceleration - 1+ pauses
lmer.side.amax.pause1 <- lmer(log10(side_amax+1) ~ pauses_side + (1|ID), data = lab.data_side_pause_1)
summary(lmer.side.amax.pause1)
anova(lmer.side.amax.pause1)   #not working for some reason
tukey.lmer.side.amax.pause1 <- emmeans(lmer.side.amax.pause0, pairwise ~ pauses_side, adjust="tukey", data=lab.data_side_pause_0)
tukey.lmer.side.amax.pause1

#lme() wouldn't work for some reason

#not sure what this is saying
```

```{r}
is.numeric(lab.data_side_pause_0$pauses_side)
```


> Sex

```{r}
side.amax.sex <- lmer(log_side_amax ~ log_bipedal_side + substrate_type + sex + (1|ID), data = lab.data)
anova(side.amax.sex)
summary(side.amax.sex)

side.amax.sex_null <- lmer(log_side_amax ~ log_bipedal_side + substrate_type + (1|ID), data = lab.data)
anova(side.amax.sex_null)
summary(side.amax.sex_null)
```


> Question 1

> Work from meeting with Eric

```{r}
#Ground Clutter Crossed vs. Speed
speed_ground_cover <- lmer(speed ~ ground_clutter_crossed + (1 | ï..ID), data = McElroy_Habitat_Data2)
anova(speed_ground_cover)
summary(speed_ground_cover)

speed_ground_cover_null <- lmer(speed ~ (1 | ï..ID), data = McElroy_Habitat_Data2)

plot(McElroy_Habitat_Data2$ground_clutter_crossed, McElroy_Habitat_Data2$speed)

ggplot(McElroy_Habitat_Data2, aes(ground_clutter_crossed, speed)) +
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(title = "Ground Clutter Crossed vs Speed in Habitat Data")

#There is a slight upward trend in speed as number of ground clutter crossed increases. This suggests that Racerunners run slightly faster when there are more obstacles in their path. 
```
  

```{r}
#ensuring ground_clutter_crossed is still numeric (it wasn't before, but we changed it, hence the "2" at the end of the dataset name)
is.numeric(McElroy_Habitat_Data2$ground_clutter_crossed)
```

```{r}
#Likelihood ratio test to compare the fit of 2 models
speed_ground_cover_null <- lmer(speed ~ (1 | ï..ID), data = McElroy_Habitat_Data2)
lrtest(speed_ground_cover, speed_ground_cover_null)  #p-value: 0.6112
lrtest(speed_ground_cover_null, speed_ground_cover)   #p-value: 0.6112

#creating a null function allows you to see if adding in a variable does a lot to change the variation in the analysis
#changing the order of the lrtest doesn't change the outcome of the likelihood test
#Ho: the smaller model is the "best" model. It's rejected when the p-value is large (like it is here), which means that the larger model is a significant improvement over the smaller one.   https://www.statisticshowto.com/likelihood-ratio-tests/
  #This means that speed ground clutter crossed does impact speed
```

```{r}
performance::r2(speed_ground_cover)
performance::r2(speed_ground_cover_null)

#conditional and marginal R2s are both higher for regular model (non-null)
```



```{r}
anova(speed_ground_cover)
summary(speed_ground_cover)

lm(speed ~ ground_clutter_crossed, data = McElroy_Habitat_Data2)
anova(lm(speed ~ ground_clutter_crossed, data = McElroy_Habitat_Data2))
anova(lm(log10(speed) ~ log10(ground_clutter_crossed +1) , data = McElroy_Habitat_Data2))
```

```{r}
#Ground Clutter Crossed vs. Speed Lmer Models

#Regular Model
speed.clutter <- lme(speed ~ ground_clutter_crossed, random= ~1|ï..ID, data = McElroy_Habitat_Data2, na.action=na.omit)
anova(speed.clutter)   #p-value = 0.0308  #significant
hist(residuals(speed.clutter))
shapiro.test(residuals(speed.clutter))  #not normal
summary(speed.clutter)
performance::r2(speed.clutter)   #low R2s

#Log-transformed Model
log.speed.clutter <- lme(log10(speed) ~ log10(ground_clutter_crossed+1), random= ~1|ï..ID, data = McElroy_Habitat_Data2, na.action=na.omit)
anova(log.speed.clutter)   #p-value = 0.0412  #significant
hist(residuals(log.speed.clutter))
shapiro.test(residuals(log.speed.clutter))  #normal p=0.2585
performance::r2(log.speed.clutter)  #low R2s

plot(log10(McElroy_Habitat_Data2$ground_clutter_crossed +1), log10(McElroy_Habitat_Data2$speed))
ggplot(McElroy_Habitat_Data2, aes(log10(ground_clutter_crossed+1), log10(speed)) )+
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(title = "Log Ground Clutter Crossed vs Log Speed in Habitat Data")

#have to use log-transformed model because non-transformed is not normal
```

# R2 determines how much a variable's behavior can explain the behavior of another variable. A measure 0f 70% or more means that the behavior of the dependent variable is highly explained by the behavior of the independent variable being studied.
  # marginal R2 describes the proportion of variance explained by the fixed factor(s) alone.
  # conditoinal R2 describes the proportion of variance explained by both the fixed and random factors.



> post-meeting

```{r}
lsmeans(random, pairwise ~ ground_clutter_crossed, adjust = "tukey", data=McElroy_Habitat_Data2)
```

```{r}
#Cover vs distance plot of transect data
ggplot(data = field_transects_totals, aes(x=cover_space_cm, y=distance_cm, color = substrate)) +
  geom_point() +
  labs(title = "Transect Data: Cover (cm) vs. Distance (cm)")
```

```{r}
#Distance of Movement vs. Speed
speed_distance_move <- lmer(speed ~ distance_movement + (1 | ï..ID), data = McElroy_Habitat_Data2)
anova(speed_distance_move)
summary(speed_distance_move)

speed_distance_move_null <- lmer(speed ~ (1 | ï..ID), data = McElroy_Habitat_Data2)

ggplot(McElroy_Habitat_Data2, aes(distance_movement, speed)) +
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(title = "Distance of Movement vs Speed in Habitat Data")

#There is a slight upward trend in speed as the distance of each movement increases. This suggests that Racerunners run slightly faster when they run longer distances. 
```


> Bipedalism on difference substrates

```{r}
#Bipedalism percentage per substrate and sex Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type + sex) +
  facet_grid(sex ~ substrate_type) +
  labs(title = "Histogram of Bipedalism Percentage per Substrate")

#mean, median & range of bipedal percentage separated into substrate type
summaryBy(bipedal_percent ~ substrate_type + sex, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#males are bipedal more often on every substrate than females

##for final manuscript, change plot titles to actual names instead of letters
### https://www.zevross.com/blog/2019/04/02/easy-multi-panel-plots-in-r-using-facet_wrap-and-facet_grid-from-ggplot2/ 
```

```{r}
#Histogram of bipedal percent without NA's separated into substrate type and sex
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type, alpha=sex)) +
  geom_histogram(bins = 20, binwidth = 8) +
  facet_wrap(~substrate_type) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Separated by Substrate Type and Sex")

#Boxplot of bipedal percent without N/A's separated by substrate type and sex
ggplot(data = lab.data_omit, aes(substrate_type, as.numeric(bipedal_percent), fill = sex)) +
  geom_boxplot() +
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Substrate Type and Sex")

#Histogram of bipedal percent without N/A's broken into substrate type
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type)) +
  geom_histogram(col = "white") + 
  labs(title = "Histogram of Bipedal Percent (without N/As) Broken Down by Substrate Type")
```


# Trying to compare heavy vs. light obstacles crossed in McElroy habitat data. However, there probably is not enough heavy data to do a good analysis on. Therefore comparing this to the light data is probably pointless.
# 0-9 obstsacles = light
# 10-20 obstacles = heavy
```{r}
#Ground clutter crossed (heavy) vs. speed
speed.clutter.heavy <- lme(log10(speed+1) ~ log10(ground_clutter_crossed+1), random= ~1|ID, data = McElroy_Habitat_Data2_heavy, na.action=na.omit)
anova(speed.clutter.heavy)  #p-value = 02644  #not significant
hist(residuals(speed.clutter))
shapiro.test(residuals(speed.clutter.heavy))  #normal
summary(speed.clutter.heavy)
performance::r2(speed.clutter.heavy)   #low R2s

#Ground clutter crossed (light) vs. speed
speed.clutter.light <- lme(log10(speed+1) ~ log(ground_clutter_crossed+1), random= ~1|ID, data = McElroy_Habitat_Data2_light, na.action=na.omit)
anova(speed.clutter.light)  #p-value = 0.0309  # significant
hist(residuals(speed.clutter))
shapiro.test(residuals(speed.clutter.light))  #normal
summary(speed.clutter.light)
performance::r2(speed.clutter.light)   #low R2s
```




Question 3: Is the pattern observed in question #1 explained by question #2?
 Ho: Racerunners run the same on all substrates.
 Ha: Racerunners avoid moving on suboptimal parts of habitat.


> McElroy fieldspeed data

# SAND and DEBRIS were easy to tell,  however, MIXED was usually some open sand with patched of debris 'mixed' in, so it's a much more heterogenous category.   
# I suggest you compute the proportion of movements that were on each substrate type and if there is a relationship between speed and substrate type in the field.  You might think of other comparisons you could make.  You might also try the mixed model, because there data are 'repeated' measurements (i.e. each lizard has 1-4 movements, so there is a clumping of movements within lizard).


```{r}
is.factor(fieldspeed_final$ID)  #changed IDs to letters in fieldspeed_final so that they were factors b/c couldn't figure out how to change in r
is.factor(fieldspeed_final$ID)
is.factor(fieldspeed_final$Substrate.Type)
is.numeric(fieldspeed_final$Segment.)
is.numeric(fieldspeed_final$NumberClutter)
```

```{r}
#Speed vs. Substrate Type 
mcelroy_speed_sub_lme <- lme(Speed ~ Substrate.Type, random = ~1|ID, data = fieldspeed_final, na.action=na.omit)
anova(mcelroy_speed_sub_lme)  #p-value=0.3845  #not significant
mcelroy_speed_sub_lme_tukey <- emmeans(mcelroy_speed_sub_lme, pairwise ~ Substrate.Type, adjust = "tukey", data = fieldspeed_final)
mcelroy_speed_sub_lme_tukey  #no substrates are signficant
hist(residuals(mcelroy_speed_sub_lme))
shapiro.test(residuals(mcelroy_speed_sub_lme))  #normal

fieldspeed_final3 <- read.csv("~/College of Charleston/Thesis/Data/McElroy Habitat Data/fieldspeed_final3.csv")  
  #removed 2 blank substrate rows b/c couldn't figure out how to plot boxplot without them

ggplot(data = fieldspeed_final3, aes(x = Substrate.Type, y = Speed)) +
  geom_boxplot() +
  labs(x = "Substrate Type", y = "Speed (m/s)") +
  scale_x_discrete(labels = c("Debris", "Mixed", "Sand")) +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5)) 


#Substrate type doesn't appear to affect speed at all

anova(lme(Speed ~ Substrate.Type + Sex, random = ~1|ID, data = fieldspeed_final, na.action = na.omit))
#Sex doesn't affect model either
```


```{r}
ggplot(data = fieldspeed_final, aes(Segment.), alpha = Substrate.Type.) +
  geom_histogram() +
  facet_wrap(~Substrate.Type) +
  labs(x = "Movement Segment") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
```

```{r}
table(fieldspeed_final$Segment.)                    #total: 46
table(fieldspeed_final$Substrate.Type == "DEBRIS")  #2  (4.3%)
table(fieldspeed_final$Substrate.Type == "MIXED")   #12 (26.1%)
table(fieldspeed_final$Substrate.Type == "SAND")    #30 (65.2%)
table(fieldspeed_final$Substrate.Type == "")        #2  (4.3%)

#most of lizards' movements are happening on sand, then mixed, and only a few happen on debris
```


#Speed vs. Number Clutter 

```{r}
mcelroy_speed_clutter_lme <- lme(Speed ~ NumberClutter, random = ~1|ID, data = fieldspeed_final, na.action=na.omit)
anova(mcelroy_speed_clutter_lme)  #p-value=0.1097  #not significant
mcelroy_speed_clutter_lme_tukey <- emmeans(mcelroy_speed_clutter_lme, pairwise ~ NumberClutter, adjust = "tukey", data = fieldspeed_final, 
                                           na.action = na.omit)
mcelroy_speed_clutter_lme_tukey  #nothing to compare
shapiro.test(residuals(mcelroy_speed_clutter_lme))  #normal
hist(residuals(mcelroy_speed_clutter_lme))
performance::r2(mcelroy_speed_clutter_lme)  #ok  #C=0.280   #M=0.075

#Number of clutter doesn't affect speed

anova(lme(Speed ~ NumberClutter + Sex + Substrate.Type, random = ~1|ID, data = fieldspeed_final, na.action = na.omit))
anova(lme(Speed ~ NumberClutter + Substrate.Type, random = ~1|ID, data = fieldspeed_final, na.action = na.omit))
anova(lme(Speed ~ NumberClutter + Sex, random = ~1|ID, data = fieldspeed_final, na.action = na.omit))
#Neither sex nor substrate type affect speed ~ numberclutter
```

```{r}
#Log transformed Speed vs.log-transformed number clutter
mcelroy_speed_clutter_lme_log <- lme(log10(Speed) ~ log10(NumberClutter+1), random = ~1|ID, data = fieldspeed_final, na.action = na.omit)
anova(mcelroy_speed_clutter_lme_log)  #p-value=0.0943  #not significant
shapiro.test(residuals(mcelroy_speed_clutter_lme_log))  #not normal
hist(residuals(mcelroy_speed_clutter_lme_log))
performance::r2(mcelroy_speed_clutter_lme_log)  #ok  #C=0.258   #M=0.087
```

```{r}
#Log transformed Speed vs.number clutter
mcelroy_speed_clutter_lme_log2 <- lme(log10(Speed) ~ NumberClutter, random = ~1|ID, data = fieldspeed_final, na.action = na.omit)
anova(mcelroy_speed_clutter_lme_log2)  #p-value=0.0943  #not significant
shapiro.test(residuals(mcelroy_speed_clutter_lme_log2))  #not normal
hist(residuals(mcelroy_speed_clutter_lme_log2))
performance::r2(mcelroy_speed_clutter_lme_log2)  #ok  #C=0.273   #M=0.073
```

```{r}
#Speed vs Log transformed number clutter  -- best model
mcelroy_speed_clutter_lme_log3 <- lme(Speed ~ log10(NumberClutter+1), random = ~1|ID, data = fieldspeed_final, na.action = na.omit)
anova(mcelroy_speed_clutter_lme_log3)  #p-value=0.0703  #not significant
shapiro.test(residuals(mcelroy_speed_clutter_lme_log3))  #normal
hist(residuals(mcelroy_speed_clutter_lme_log3))
performance::r2(mcelroy_speed_clutter_lme_log3)  #ok  #C=0.290   #M=0.102

ggplot(fieldspeed_final, aes(log10(NumberClutter+1), Speed))+
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(x = "Ground Clutter Crossed", y = "Speed (m/s)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))

#slight upward trend: as ground clutter increased, speed also increased slightly
```

```{r}
table(fieldspeed_final$NumberClutter)   #44
table(fieldspeed_final$ID)  #41
table(fieldspeed_final4$ID)  #37
```


#Distance vs. Clutter

```{r}
#Distance vs. Number Clutter 1
mcelroy_dist_clutter_lme <- lme(Distance ~ log10(NumberClutter+1), random = ~1|ID, data = fieldspeed_final, na.action = na.omit)
anova(mcelroy_dist_clutter_lme)  #p-value=0.0233
shapiro.test(residuals(mcelroy_dist_clutter_lme))  #not normal
hist(residuals(mcelroy_dist_clutter_lme))
performance::r2(mcelroy_dist_clutter_lme)  
```

```{r}
#Distance vs. Number Clutter 2
mcelroy_dist_clutter_lme2 <- lme(Distance ~ NumberClutter, random = ~1|ID, data = fieldspeed_final, na.action = na.omit)
anova(mcelroy_dist_clutter_lme2)  #p-value=0.0229
shapiro.test(residuals(mcelroy_dist_clutter_lme2))  #not normal
hist(residuals(mcelroy_dist_clutter_lme2))
performance::r2(mcelroy_dist_clutter_lme2)
```

```{r}
#Distance vs. Number Clutter 3 -- best model
mcelroy_dist_clutter_lme3 <- lme(log10(Distance) ~ log10(NumberClutter+1), random = ~1|ID, data = fieldspeed_final, na.action = na.omit)
anova(mcelroy_dist_clutter_lme3)  #p-value=0.0137  #significant
shapiro.test(residuals(mcelroy_dist_clutter_lme3))  #normal
hist(residuals(mcelroy_dist_clutter_lme3))
performance::r2(mcelroy_dist_clutter_lme3)  #good  #C=0.586  #M=0.154

ggplot(fieldspeed_final, aes(log10(NumberClutter+1), log10(Distance))) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Number of Clutter Crossed", y = "Distance Traveled (m)")
#trying to get dots to color-coordinate with ID, but when I put col=ID after Distance in aes, it messes up the lm line

#not sure if this analysis will be useful; it makes sense that the farther the lizards run, the more clutter they would have to cross
```


#Speed vs. Distance 

```{r}
#Speed vs. Distance
mcelroy_dist_speed_lme <- lme(log10(Speed) ~ log10(Distance), random = ~1|ID, data = fieldspeed_final, na.action=na.omit)
anova(mcelroy_dist_speed_lme)  #p-value=0.0001  #significant
shapiro.test(residuals(mcelroy_dist_speed_lme))   #normal
hist(residuals(mcelroy_dist_speed_lme))
performance::r2(mcelroy_dist_speed_lme)  #good  #C=0.702  #M=0.449

ggplot(fieldspeed_final, aes(log10(Distance), log10(Speed))) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Distance (m)", y = "Speed (m/s)") +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))
```

```{r}
fieldspeed_final_time_movement <- read.csv("~/College of Charleston/Thesis/Data/McElroy Habitat Data/fieldspeed_final_time_movement.csv")

#time spent per substrate
ggplot(fieldspeed_final_time_movement, aes(TimePerMovement)) +
  geom_histogram() +
  facet_wrap(~Substrate.Type)

summaryBy(TimePerMovement ~ Substrate.Type, data = fieldspeed_final_time_movement,
          FUN = list(mean, median, min, max))
#spent more time on sand than debris or mixed but time differences are not significant

sub.movement <- lme(log10(TimePerMovement) ~ Substrate.Type, random = ~1|ID, data = fieldspeed_final_time_movement)
anova(sub.movement)  #p-value=0.9167  #not signficant
shapiro.test(residuals(sub.movement))  #normal
hist(residuals(sub.movement))
performance::r2(sub.movement)  #C=0.592  #M=0.003
emmeans(sub.movement, pairwise ~ Substrate.Type, adjust = "tukey", data=fieldspeed_final_time_movement)
  #no differences in substrate type are significant

ggplot(fieldspeed_final_time_movement, aes(x=Substrate.Type, y=TimePerMovement)) +
  geom_boxplot()
```


```{r}
#Speed vs. Substrate Type 
mcelroy_speed_sub_lme <- lme(Speed ~ Substrate.Type, random = ~1|ID, data = fieldspeed_final, na.action=na.omit)
anova(mcelroy_speed_sub_lme)  #p-value=0.3845  #not significant
mcelroy_speed_sub_lme_tukey <- emmeans(mcelroy_speed_sub_lme, pairwise ~ Substrate.Type, adjust = "tukey", data = fieldspeed_final)
mcelroy_speed_sub_lme_tukey  #no substrates are signficant
hist(residuals(mcelroy_speed_sub_lme))
shapiro.test(residuals(mcelroy_speed_sub_lme))  #normal

anova(lme(Speed ~ Substrate.Type + Sex, random = ~1|ID, data = fieldspeed_final, na.action = na.omit))
#Sex doesn't affect model either

ggplot(data = fieldspeed_final, aes(x = Substrate.Type, y = Speed)) +
  geom_boxplot() +
  labs(x = "Substrate Type", y = "Speed (m/s)") +
  scale_x_discrete(labels = c("Debris", "Mixed", "Sand")) +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))

#Substrate type doesn't appear to affect speed at all
```

```{r}
#Speed vs. Substrate Type 
#trying to get blank box on boxplot removed but couldn't figure out how to do in R so had to make new csv file
#comparing results with above

fieldspeed_final_reduced <- read.csv("~/College of Charleston/Thesis/Data/McElroy Habitat Data/fieldspeed_final_reduced.csv")

mcelroy_speed_sub_lme2 <- lme(Speed ~ Substrate.Type, random = ~1|ID, data = fieldspeed_final_reduced, na.action=na.omit)
anova(mcelroy_speed_sub_lme2)  #p-value=0.3976  #not significant
mcelroy_speed_sub_lme_tukey2 <- emmeans(mcelroy_speed_sub_lme2, pairwise ~ Substrate.Type, adjust = "tukey", data = fieldspeed_final_reduced)
mcelroy_speed_sub_lme_tukey2  #no substrates are signficant
hist(residuals(mcelroy_speed_sub_lme2))
shapiro.test(residuals(mcelroy_speed_sub_lme2))  #normal

ggplot(data = fieldspeed_final_reduced, aes(x = Substrate.Type, y = Speed)) +
  geom_boxplot() +
  labs(x = "Substrate Type", y = "Speed (m/s)") +
  scale_x_discrete(labels = c("Debris", "Mixed", "Sand")) +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))
```



```{r}
#Velocity vs Substrate Type - Top

lme.log.top.vmax.sub <- lme(log10(top_vmax+1) ~ substrate_type, random = ~1|ID, data = lab_data)
anova(lme.log.top.vmax.sub)  #p-value=0.0004  #significant
hist(residuals(lme.log.top.vmax.sub))
shapiro.test(residuals(lme.log.top.vmax.sub))  # not normal
summary(lme.log.top.vmax.sub)
performance::r2(lme.log.top.vmax.sub)  #pretty low R2s
lme.log.top.vmax.sub.tukey <- emmeans(lme.log.top.vmax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab_data)
lme.log.top.vmax.sub.tukey  #no significant differences between substrates

#DATA IS NOT NORMAL -- TRANSFORM
#data isn't normal without log10, with log10

#no significant differences between substrates

#LOOK BACK AT!!!!!!!!!!!!!!!!!!!!!!!!!1


lme1 <- lme(top_vmax ~ substrate_type, random = ~1|ID, data = lab_data)  #un-transformed
shapiro.test(residuals(lme1))  #not normal
hist(residuals(lme1))

lme2 <- lme(sqrt(top_vmax+1) ~ substrate_type, random = ~1|ID, data = lab_data)  #square root
shapiro.test(residuals(lme2))  #not normal
hist(residuals(lme2))

lme3 <- lme(log10(top_vmax+1) ~ substrate_type, random = ~1|ID, data = lab_data)  #log
shapiro.test(residuals(lme3))  #not normal
hist(residuals(lme3))

lme4 <- lme(abs(top_vmax+1)^(1/3) ~ substrate_type, random = ~1|ID, data = lab_data)  #cubed root
shapiro.test(residuals(lme4))  #not normal
hist(residuals(lme4))

lme5 <- lme(transformTukey(top_vmax+1, plotit = FALSE) ~ substrate_type, random = ~1|ID, data = lab_data)  #TUkey's ladder of powers
shapiro.test(residuals(lme5))  #not normal
hist(residuals(lme5))
plotNormalHistogram(residuals(lme5))

lme6 <- lm(top_vmax ~ substrate_type, data = lab_data)
shapiro.test(residuals(lme6))  #normal
plotNormalHistogram(residuals(lme6))

hist(lab_data$top_vmax)
shapiro.test(lab_data$top_vmax)
```



> Racerunner Demographics

```{r}
Racerunner_demographics <- read.csv("~/College of Charleston/Thesis/Data/Racerunner_demographics.csv")

#Mean
mean(Racerunner_demographics$svl)  #mean = 6.32 cm
mean(Racerunner_demographics$tail_length)   #mean = 13.04 cm (including 2 that lost part of tail)
mean(Racerunner_demographics$weight)   #mean = 5.91 g

#Range
range(Racerunner_demographics$svl)  #range = 5.59, 7.80
range(Racerunner_demographics$tail_length)   #range = 4.20, 16.10
range(Racerunner_demographics$weight)   #range = 4.09, 8.76
```

#mean, median & range of demographic data separated by sex
```{r}
#SVL
summaryBy(svl ~ sex, data = Racerunner_demographics,
          FUN = list(mean, median, min, max))
svl.f <- Racerunner_demographics$svl[Racerunner_demographics$sex=="F"]
svl.m <- Racerunner_demographics$svl[Racerunner_demographics$sex=="M"]
t.test(svl.f, svl.m)  #p-value = 0.067  #not significant

#no significant differences in SVL length between sexes
```

```{r}
#tail length
summaryBy(tail_length ~ sex, data = Racerunner_demographics,
          FUN = list(mean, median, min, max))

f.tail_length_removed <- Racerunner_demographics[-c(12,15),]  #removing data from 2 lizards whose tails were missing

tail.f <- Racerunner_demographics$tail_length[Racerunner_demographics$sex=="F"]
tail.f2 <- f.tail_length_removed$tail_length[Racerunner_demographics$sex=="F"]
tail.m <- Racerunner_demographics$tail_length[Racerunner_demographics$sex=="M"]
t.test(tail.f, tail.m)  #p-value = 0.01117  #significant
t.test(tail.f2, tail.m)  #p-value = 0.02911  #significant

#significant differences in tail length between sexes
```

```{r}
#weight
summaryBy(weight ~ sex, data = Racerunner_demographics,
          FUN = list(mean, median, min, max))
weight.f <- Racerunner_demographics$weight[Racerunner_demographics$sex=="F"]
weight.f2 <- f.tail_length_removed$weight[Racerunner_demographics$sex=="F"]
weight.m <- Racerunner_demographics$weight[Racerunner_demographics$sex=="M"]
t.test(weight.f, weight.m)  #not significant
t.test(weight.f2, weight.m)   #not significant

#no differences in weight beteween sexes
```


```{r}
#Tmax

ggplot(data = lab_data, aes(log10(side_tmax))) +
  geom_histogram(bins=11)
shapiro.test(log10(lab_data$side_tmax))

mean(lab_data$side_tmax)  #0.559 sec
range(lab_data$side_tmax)  #min=0.102 sec  #max=1.19 sec

mean(lab_data$top_tmax)  #0.541 sec
range(lab_data$top_tmax)  #min=0.302 sec  #max=1.35 sec

t.test(lab_data$side_tmax, lab_data$top_tmax)  #p-value=0.413
#the difference in time spent in each camera video is not significantly different
```

```{r}
#Pmax

mean(lab_data$side_pmax)  #0.21.23 
range(lab_data$side_pmax)  #min=6.605   #max=64.22

mean(lab_data$top_pmax)  #17.38
range(lab_data$top_pmax)  #min=3.30  #max=69.02

t.test(lab_data$side_pmax, lab_data$top_pmax)
```

```{r}
#Posmax

mean(lab_data$side_posmax) 
range(lab_data$side_posmax) 

mean(lab_data$top_posmax) 
range(lab_data$top_posmax)  

t.test(lab_data$side_posmax, lab_data$top_posmax)

#posmax probably not needed because the position of the lizard is obviously going to change throughout the run because it's moving
```

```{r}
citation("lme4")
```

> Racerunner Morphometrics
  # Eric said I do not need to include in final data

```{r}
#Mean
mean(Racerunner_demographics$svl)  #mean = 6.32 cm
mean(Racerunner_demographics$tail_length)   #mean = 13.04 cm (including 2 that lost part of tail)
mean(Racerunner_demographics$weight)   #mean = 5.91 g

#Range
range(Racerunner_demographics$svl)  #range = 5.59, 7.80
range(Racerunner_demographics$tail_length)   #range = 4.20, 16.10
range(Racerunner_demographics$weight)   #range = 4.09, 8.76
```

#mean, median & range of demographic data separated by sex
```{r}
#SVL
summaryBy(svl ~ sex, data = Racerunner_demographics,
          FUN = list(mean, median, min, max))
svl.f <- Racerunner_demographics$svl[Racerunner_demographics$sex=="F"]
svl.m <- Racerunner_demographics$svl[Racerunner_demographics$sex=="M"]
t.test(svl.f, svl.m)  #p-value = 0.067  #not significant

ggplot(data = Racerunner_demographics, aes(x = sex, y = svl, fill = sex)) +
  geom_boxplot() +
  labs(x = "Sex", y = "SVL (cm)") +
  scale_x_discrete(labels = c("Female", "Male")) +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))

#no significant differences in SVL length between sexes
```

```{r}
#tail length
summaryBy(tail_length ~ sex, data = Racerunner_demographics,
          FUN = list(mean, median, min, max))

f.tail_length_removed <- Racerunner_demographics[-c(12,15),]  #removing data from 2 lizards whose tails were missing

summaryBy(tail_length ~ sex, data = f.tail_length_removed,
          FUN = list(mean, median, min, max))

tail.f <- Racerunner_demographics$tail_length[Racerunner_demographics$sex=="F"]
tail.f2 <- f.tail_length_removed$tail_length[Racerunner_demographics$sex=="F"]
tail.m <- Racerunner_demographics$tail_length[Racerunner_demographics$sex=="M"]
t.test(tail.f, tail.m)  #p-value = 0.01117  #significant
t.test(tail.f2, tail.m)  #p-value = 0.02911  #significant

ggplot(data = f.tail_length_removed, aes(x = sex, y = tail_length, fill = sex)) +
  geom_boxplot() +
  labs(x = "Sex", y = "Tail Length (cm)") +
  scale_x_discrete(labels = c("Female", "Male")) +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))

#significant differences in tail length between sexes
```

```{r}
#weight
summaryBy(weight ~ sex, data = Racerunner_demographics,
          FUN = list(mean, median, min, max))
weight.f <- Racerunner_demographics$weight[Racerunner_demographics$sex=="F"]
weight.f2 <- f.tail_length_removed$weight[Racerunner_demographics$sex=="F"]
weight.m <- Racerunner_demographics$weight[Racerunner_demographics$sex=="M"]
t.test(weight.f, weight.m)  #not significant
t.test(weight.f2, weight.m)   #not significant

ggplot(data = f.tail_length_removed, aes(x = sex, y = weight, fill = sex)) +
  geom_boxplot() +
  labs(x = "Sex", y = "Weight (g)") +
  scale_x_discrete(labels = c("Female", "Male")) +
  theme(panel.background = element_blank()) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))

#no differences in weight beteween sexes
```


```{r}
#Ground Clutter Crossed vs. Speed

log.speed.clutter <- lme(log10(Speed) ~ log10(NumberClutter+1) + Sex, random= ~1|ID, data = fieldspeed, na.action=na.omit)
anova(log.speed.clutter)   #p-value substrate = 0.1426  #not significant
hist(residuals(log.speed.clutter))
shapiro.test(residuals(log.speed.clutter))  #normal  
performance::r2(log.speed.clutter)  #C=0.281 #M=0.091

ggplot(fieldspeed, aes(log10(NumberClutter+1), log10(Speed)) )+
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(x = "Ground Clutter Crossed", y = "Speed (m/s)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))

#Slight upward trend: as ground clutter increases, so does speed
``` 



> Data deleted from Thesis_Stats_all 12/4/20 because combined camera peak velocity and bipedalism 


```{r}
#Velocity vs Substrate Type - Side
lme.log.side.vmax.sub <- lme(log10(side_vmax+1) ~ substrate_type + sex, random = ~1|ID, data = lab_data)
anova(lme.log.side.vmax.sub)  #p-value substrate=0.0029, significant  #sex insignificant
ggplot(lab_data, aes(residuals(lme.log.side.vmax.sub))) + 
  geom_histogram(bins = 11, color = "white") +
  labs(x = "Residuals of lme.log.side.vmax.sub") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.log.side.vmax.sub))  #normal (but just barely)
summary(lme.log.side.vmax.sub)
performance::r2(lme.log.side.vmax.sub)  #C=0.387 #M=0.065
lme.log.side.vmax.sub.tukey <- emmeans(lme.log.side.vmax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab_data)
lme.log.side.vmax.sub.tukey  #significant differences between D-S but not D-SD or S-SD

ggplot(lab_data, aes(y=log10(side_vmax+1), x=substrate_type)) +  #fill = substrate_type
  geom_boxplot() + 
  labs(x = "Substrate", y = "Velocity (side camera) (m/s)") +
  scale_x_discrete(labels = c("Debris", "Sand", "Mixed")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black")) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5))
```

```{r}
#Velocity vs Substrate Type - Side
ggplot(data = lab_data, aes(side_vmax))  + 
  geom_histogram(bins = 8) +
  facet_wrap(~substrate_type) +
  facet_grid(~substrate_type,
             labeller = labeller(substrate_type=sub.labs)) +
  labs(x = "Velocity (Side Camera) (m/s)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

#mean, median & range of top max velocity separated into substrate types
summaryBy(side_vmax ~ substrate_type, data = lab_data,
          FUN = list(mean, median, min, max))
```

```{r}
#Velocity vs Substrate Type - Top

lme.log.top.vmax.sub <- lme(log10(top_vmax+1) ~ substrate_type + sex, random = ~1|ID, data = lab_data)
anova(lme.log.top.vmax.sub)  #p-value substrate=0.0005  #significant   #sex insignificant
hist(residuals(lme.log.top.vmax.sub))
shapiro.test(residuals(lme.log.top.vmax.sub))  # not normal
summary(lme.log.top.vmax.sub)
performance::r2(lme.log.top.vmax.sub)  #pretty low R2s
lme.log.top.vmax.sub.tukey <- emmeans(lme.log.top.vmax.sub, pairwise ~ substrate_type, adjust="tukey", data=lab_data)
lme.log.top.vmax.sub.tukey  #no significant differences between substrates

#DATA IS NOT NORMAL -- TRANSFORM
```

```{r}
#Transformations of Velocity vs Substrate Type - Top
#none of the transformations are normal

lme1 <- lme(top_vmax ~ substrate_type, random = ~1|ID, data = lab_data)  #un-transformed
shapiro.test(residuals(lme1))  #not normal
hist(residuals(lme1))

lme2 <- lme(sqrt(top_vmax+1) ~ substrate_type, random = ~1|ID, data = lab_data)  #square root
shapiro.test(residuals(lme2))  #not normal
hist(residuals(lme2))

lme3 <- lme(log10(top_vmax+1) ~ substrate_type, random = ~1|ID, data = lab_data)  #log
shapiro.test(residuals(lme3))  #not normal
hist(residuals(lme3))

lme4 <- lme(abs(top_vmax+1)^(1/3) ~ substrate_type, random = ~1|ID, data = lab_data)  #cubed root
shapiro.test(residuals(lme4))  #not normal
hist(residuals(lme4))

lme5 <- lme(transformTukey(top_vmax+1, plotit = FALSE) ~ substrate_type, random = ~1|ID, data = lab_data)  #TUkey's ladder of powers
shapiro.test(residuals(lme5))  #not normal
hist(residuals(lme5))
hist(residuals(lme5))

lme6 <- lm(top_vmax ~ substrate_type, data = lab_data)
shapiro.test(residuals(lme6))  #normal but not a mixed-effect model
hist(residuals(lme6))

hist(lab_data$top_vmax)
shapiro.test(lab_data$top_vmax)
```

```{r}
#Top max velocity per substrate 
ggplot(data = lab_data, aes(top_vmax))  + 
  geom_histogram(bins = 8) +
  facet_wrap(~substrate_type) +
  facet_grid(~substrate_type,
             labeller = labeller(substrate_type=sub.labs)) +
  labs(x = "Velocity (Top Camera) (m/s)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

#mean, median & range of top max velocity separated into substrate types
summaryBy(top_vmax ~ substrate_type, data = lab_data,
          FUN = list(mean, median, min, max))
```


```{r}
lab_data2 <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_final_12.04.20_removed_non-standstill_starts+NAs+negatives+3lizards+peak_v_biped.csv")

is.numeric(lab_data2$biped_tot)
is.numeric(lab_data2$peak_v)
is.factor(lab_data2$peak_v_cam)
```


#replaced with lab_data2_omit data
```{r}
#Bipedalism's effect on side velocity
side.vmax.biped <- lme(log10(side_vmax+1) ~ log10(bipedal_percent+1) + sex, random = ~1|ID, data = lab_data_omit)
anova(side.vmax.biped)  #p-value substrate < 0.0001  significant   #sex is insignificant
hist(residuals(side.vmax.biped))
shapiro.test(residuals(side.vmax.biped))  #normal
performance::r2(side.vmax.biped)  #C=0.303  #M=0.303

ggplot(lab_data_omit, aes(log10(bipedal_percent+1), log10(side_vmax+1))) +
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(x = "Percent Bipedal", y = "Velocity (side) (m/s)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))

#bipedalism does effect velocity in side videos
```


```{r}
#Bipedalism's effect on top velocity
top.vmax.biped <- lme(log10(top_vmax+1) ~ log10(bipedal_percent+1) + sex, random = ~1|ID, data = lab_data_omit)
anova(top.vmax.biped)  #p-value substrate & sex = insignificant
hist(residuals(top.vmax.biped))
shapiro.test(residuals(top.vmax.biped))  #normal
performance::r2(top.vmax.biped)  #C=0.420  #M=0.075

ggplot(lab_data_omit, aes(log10(bipedal_percent+1), log10(top_vmax+1))) +
  geom_point() + 
  geom_smooth(method = 'lm') +
  labs(x = "Percent Bipedal", y = "Velocity (top) (m/s)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))

#bipedalsim does not effect velocity in top videos
```



```{r}
#Number of Pauses
table(lab_data2$pauses_side)
table(lab_data2$pauses_top)
```

```{r}
#Tmax

mean(lab_data2$side_tmax)  #0.559 sec
range(lab_data2$side_tmax)  #min=0.102 sec  #max=1.19 sec

mean(lab_data2$top_tmax)  #0.541 sec
range(lab_data2$top_tmax)  #min=0.302 sec  #max=1.35 sec

t.test(lab_data2$side_tmax, lab_data2$top_tmax)  #p-value=0.413
#the difference in time spent in each camera video is not significantly different
```

```{r}
table(lab_data2$bipedal_quad_side)  #total = 139
#sum(lab_data$bipedal_side)
#sum bipedal_side = 5390 frames bipedal
table(lab_data2$bipedal_quad_top)  #total = 139
#sum(lab_data$bipedal_top)
#sum bipedal_top = 6982 frames bipedal
```

```{r}
#amount of obstacles crossed in fieldspeed data
summary(fieldspeed$NumberClutter==0)
summary(fieldspeed$NumberClutter==1)
#0 obstacles = 13
#1 obstacle = 3
#>1 obstacle = 30

mean(fieldspeed$NumberClutter)
#mean clutter per movement = 3.56
mean(fieldspeed$Distance)
#mean distance per movement = 1.183 m

3.56/1.183  #3.01 obstacles per meter
```

```{r}
#trying to make a pie chart of substrates in habitat assessment
ggplot(field_transect_data_totals, aes (x="", y = distance_m, fill = substrate)) + 
  geom_col(position = 'stack', width = 1) +
  geom_text(aes(label = percent_type, x = 1.2),
            position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette = "Blues", direction = -1) +
  theme(plot.title = element_text(hjust=0.5),
        axis.line = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) +
  labs(fill = "Substrate",
       x = NULL,
       y = NULL,
       title = NULL) + 
    coord_polar("y", start = 0) +
  theme_void() 
```


CHI-SQUARED TEST (for available habitat (random) vs. field data (used))

```{r}
#use an example
iris.data <- iris
iris.data$size <- ifelse(iris.data$Sepal.Length < median(iris.data$Sepal.Length),
  "small", "big")
iris.data
table(iris.data$Species, iris.data$size)
```

```{r}
#Chi Square test to see if % habitat is related to % field data
  #Ho: % habitat and % field data are not associated, i.e., are independent
  #Ha: % habitat and % field data are associeated, i.e. are dependent

#need 2 categorical variables

chisq.test(field_transect_condensed$percent_type, fieldspeed_substrate_percent$PercentSubstrate)  #p=0.1991
chisq.test(field_transect_condensed$substrate, fieldspeed_substrate_percent$Substrate.Type)  ##p=0.1991

chi_sq <-  read.csv("~/College of Charleston/Thesis/Data/chi_square_habitat_vs_field.csv")

table(field_transect_condensed$percent_type, fieldspeed_substrate_percent$PercentSubstrate)
table(field_transect_condensed$substrate, field_transect_condensed$percent_type)
table(field_transect_condensed$percent_type, fieldspeed_substrate_percent)

chi2 <- read.csv("~/College of Charleston/Thesis/Data/chi_square_habitat_vs_field.csv")
chi_rank <- table(chi2$habitat_rank, chi2$field_rank)

dat <- ifelse(chi_sq$percent_habitat)
```

```{r}
habitat <- matrix(c(49.41, 1.98, 34.02, 32.01, 16.58, 66.00), ncol = 2, byrow = TRUE)
colnames(habitat) <- c("random", "used")
rownames(habitat) <- c("debris", "mixed", "sand")
habitat <- as.table(habitat)
habitat
summary(habitat)
```

```{r}
#substrates = species
# columns = random, used

chi_sq$habitat <- ifelse(chi_sq$random == chi_sq$random, "random", "used")

chi_sq$dat <- table(chi_sq$substrate,habitat)

length(chi_sq$substrate)
length(habitat)

random <- matrix(c(49.41, 34.02, 16.58))
random
used <- matrix(c(1.98, 32.01, 66.00))
used

habitat <- table(random, used)
habitat
```

```{r}
#Chi Square test to see if % habitat is related to % field data
  #Ho: % habitat and % field data are not associated, i.e., are independent
  #Ha: % habitat and % field data are associeated, i.e. are dependent

#need 2 categorical variables

habitat <- matrix(c(49.41, 1.98, 34.02, 32.01, 16.58, 66.00), ncol = 2, byrow = TRUE)
colnames(habitat) <- c("random", "used")
rownames(habitat) <- c("debris", "mixed", "sand")
habitat <- as.table(habitat)
habitat
summary(habitat)
```

```{r}
chisq.test(habitat)
prop.test(habitat)
```

```{r}
prop.test(x = c(49.41, 1.98), n = c(100,100))
```

```{r}
habitat2 <- matrix(c(0.4941, 0.0198, 0.3402, 0.3201, 0.1658, 0.66), ncol = 2, byrow = TRUE)
colnames(habitat2) <- c("random", "used")
rownames(habitat2) <- c("debris", "mixed", "sand")
habitat2 <- as.table(habitat2)
habitat2

prop.test(habitat2)
```

```{r}
dat <- matrix(c(0.4941, 0.0198, 0.3402, 0.3201, 0.1658, 0.66), ncol = 2, byrow = TRUE)
colnames(dat) <- c("random", "used")
dat

substrate <- matrix(c("debris", "mixed", "sand"), ncol = 1)
substrate

hab <- table(substrate, dat)
length(substrate)
```

```{r}
random <- c(0.494, 0.3402, 0.1658)
used <- c(0.0198, 0.3202, 0.6600)
sum(random)
sum(used)
chisq.test(random, p=used)
prop.test(random, used)
prop.test(x=c(random, used), n=c(1,1))
```

```{r}
dat2 <- matrix(c(1899.5, 1.05, 1307.95, 16.94, 637.45, 34.93), ncol = 2, byrow = TRUE)
colnames(dat2) <- c("random", "used")
rownames(dat2) <- c("debris", "mixed", "sand")
dat2

dat3 <- c(1899.5, 1.05, 1307.95, 16.94, 637.45, 34.93)
dat3
sub <- c("debris", "mixed", "random")
sub

dat <- read.csv("~/College of Charleston/Thesis/Data/dat.csv")
dat$hab <- ifelse(dat$distance > 500, "random", "used")
dat$hab
table(dat$ï..substrate, dat$hab)
chisq.test(dat$hab, dat$distance)
```

```{r}
chisq <- read.csv("~/College of Charleston/Thesis/Data/chisq.csv")

chisq2 <- as.table(as.matrix(chisq))
chisq2

chisq.test(chisq2)
```

```{r}
# this one worked (I think). FINAL RESULTS - only this chunk is needed in final stats
env <- matrix(c(1899.5, 1.05, 1307.95, 16.94, 637.45, 34.928), ncol = 2, byrow = TRUE)
colnames(env) <- c("random", "used")
rownames(env) <- c("debris", "mixed", "sand")
env

chisq.test(env)
```



#2/16/21 Adding speed ~ substrate + bipedal plots like Eric suggested


```{r}
setwd("~/College of Charleston/Thesis/R_Data")
lab_data3_omit <- read.csv("lab_data3_omit.csv")
```


```{r}
#Speed ~ Substrate + Biped: Side Camera
lme.vmax.sub.biped <- lme(log10(peak_v+1) ~ substrate_type + bipedal_quad_side, random = ~1|ID, data = lab_data2)
anova(lme.vmax.sub.biped)  #p_substrate < 0.0001,  p_bipedal = 0.0003
ggplot(lab_data2, aes(residuals(lme.vmax.sub.biped))) + 
  geom_histogram(bins = 11, color = "white") +
  labs(x = "Residuals of lme.vmax.sub.biped") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.vmax.sub.biped))  #normal
summary(lme.vmax.sub.biped)
performance::r2(lme.vmax.sub.biped)  #C=0.366, M=0.194
lme.lme.vmax.sub.biped.tukey <- emmeans(lme.vmax.sub.biped, pairwise ~ substrate_type, adjust="tukey", data=lab_data2)
lme.lme.vmax.sub.biped.tukey  #D-S p=0.0013, D-SD p=0.0667, S-SD p=0.2470
  #bipedalism is significantly different between debris and sand and just barely insignificant between debris and mixed
```

```{r}
#ggplot for speed vs. substrate separated into bipedalism for side camera
ggplot(lab_data2_omit, aes(y=peak_v, x=substrate_type, fill = bipedal_quad_side)) +
  geom_boxplot() + 
  scale_fill_discrete(name = "Bipedal/Quadrupedal", labels = c("bipedal", "quadrupedal")) +
  labs(x = "Substrate", y = "Peak Velocity (m/s)") +
  scale_x_discrete(labels = c("Debris", "Sand", "Mixed")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black")) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5),
        axis.text = element_text(face = "bold"))
```

```{r}
#Speed ~ Substrate + Biped: Top Camera
lme.vmax.sub.biped2 <- lme(log10(peak_v+1) ~ substrate_type + bipedal_quad_top, random = ~1|ID, data = lab_data2)
anova(lme.vmax.sub.biped2)  #p_substrate < 0.0001,  p_bipedl < 0.0001
ggplot(lab_data2, aes(residuals(lme.vmax.sub.biped2))) + 
  geom_histogram(bins = 11, color = "white") +
  labs(x = "Residuals of lme.vmax.sub.biped") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.vmax.sub.biped2))  #normal
summary(lme.vmax.sub.biped2)
performance::r2(lme.vmax.sub.biped2)  #C=0.451, M=0.330
lme.lme.vmax.sub.biped.tukey2 <- emmeans(lme.vmax.sub.biped2, pairwise ~ substrate_type, adjust="tukey", data=lab_data2)
lme.lme.vmax.sub.biped.tukey2  #D-S p=0.0022, D-SD p=0.0849, S-SD p=0.2853
  #bipedalism is significantly different between debris and sand 
```


```{r}
#ggplot for speed vs. substrate separated into bipedalism for top camera
ggplot(lab_data2_omit, aes(y=peak_v, x=substrate_type, fill = bipedal_quad_top)) +
  geom_boxplot() + 
  scale_fill_discrete(name = "Bipedal/Quadrupedal", labels = c("bipedal", "quadrupedal")) +
  labs(x = "Substrate", y = "Peak Velocity (m/s)") +
  scale_x_discrete(labels = c("Debris", "Sand", "Mixed")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black")) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5),
        axis.text = element_text(face = "bold"))
```

```{r}
#Speed ~ Substrate + Biped: Combined
lme.vmax.sub.biped3 <- lme(log10(peak_v+1) ~ substrate_type + biped_combined, random = ~1|ID, data = lab_data2)
anova(lme.vmax.sub.biped3)  #p_substrate < 0.0001,  p_biped_comb < 0.0001
ggplot(lab_data2, aes(residuals(lme.vmax.sub.biped3))) + 
  geom_histogram(bins = 11, color = "white") +
  labs(x = "Residuals of lme.vmax.sub.biped") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.vmax.sub.biped3))  #normal
summary(lme.vmax.sub.biped3)
performance::r2(lme.vmax.sub.biped3)  #C=0.466, M=0.335
lme.lme.vmax.sub.biped.tukey3 <- emmeans(lme.vmax.sub.biped3, pairwise ~ substrate_type, adjust="tukey", data=lab_data2)
lme.lme.vmax.sub.biped.tukey3  #D-S p=0.0006, D-SD p=0.0399, S-SD p=0.2526
  #bipedalism is significantly different between debris and sand 
```

```{r}
#ggplot for speed vs. substrate separated into bipedalism for combined
ggplot(lab_data2, aes(y=peak_v, x=substrate_type, fill = biped_combined)) +
  geom_boxplot() + 
  scale_fill_discrete(name = "Bipedal/Quadrupedal", labels = c("bipedal", "quadrupedal")) +
  labs(x = "Substrate", y = "Peak Velocity (m/s)") +
  scale_x_discrete(labels = c("Debris", "Sand", "Mixed")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black")) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5),
        axis.text = element_text(face = "bold"))
```


> SVL

```{r}
RR_demo <- read.csv("~/College of Charleston/Thesis/Data/Racerunner_demographics2.csv")
```

```{r}
#Peak Velocity (all) vs SVL 
lme.log.side.vmax.svl <- lme(log10(peak_v+1) ~ svl, random = ~1|ID, data = RR_demo)
anova(lme.log.side.vmax.svl)  #p-value =0.6383, insignificant
ggplot(RR_demo, aes(residuals(lme.log.side.vmax.svl))) + 
  geom_histogram(bins = 11, color = "white") +
  labs(x = "Residuals of lme.log.side.vmax.svl") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.log.side.vmax.svl))  #normal
summary(lme.log.side.vmax.svl)
performance::r2(lme.log.side.vmax.svl)  #C=0.217, M=0.006

#SVL is insignificant on peak velocity
```

```{r}
#Acceleration (all) vs Sex - Side
lme.log.amax.svl <- lme(log10(peak_acc+1) ~ svl, random = ~1|ID, data = RR_demo)
anova(lme.log.amax.svl)  #p-value = 0.7712, not significant
ggplot(RR_demo, aes(residuals(lme.log.amax.svl))) + 
  geom_histogram(bins = 8, color = "white") +
  labs(x = "Residuals of lme.log.amax.svl") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.log.amax.svl))  #normal
summary(lme.log.amax.svl)
performance::r2(lme.log.amax.svl) #C=0.118, M=0.002

#svl is insignificant for acceleration
```

> Tail length

```{r}
#Peak Velocity (all) vs tail length 
lme.log.side.vmax.tail <- lme(log10(peak_v+1) ~ tail_length, random = ~1|ID, data = RR_demo)
anova(lme.log.side.vmax.tail)  #p-value =0.168, insignificant
ggplot(RR_demo, aes(residuals(lme.log.side.vmax.tail))) + 
  geom_histogram(bins = 11, color = "white") +
  labs(x = "Residuals of lme.log.side.vmax.tail") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.log.side.vmax.tail))  #normal
summary(lme.log.side.vmax.tail)
performance::r2(lme.log.side.vmax.tail)  #C=0.214, M=0.048

#tail is insignificant on peak velocity
```

```{r}
#Acceleration (all) vs tail length - Side
lme.log.amax.tail <- lme(log10(peak_acc+1) ~ tail_length, random = ~1|ID, data = RR_demo)
anova(lme.log.amax.tail)  #p-value = 0.4579, not significant
ggplot(RR_demo, aes(residuals(lme.log.amax.tail))) + 
  geom_histogram(bins = 8, color = "white") +
  labs(x = "Residuals of lme.log.amax.tail") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.log.amax.tail))  #normal
summary(lme.log.amax.tail)
performance::r2(lme.log.amax.tail) #C=0.117, M=0.012

#tail is insignificant for acceleration
```


> SVL & tail Length for each substrate type

```{r}
#Peak Velocity (debris) vs SVL 
lme.vmax.svl.d <- lme(log10(top_velocity+1) ~ svl, random = ~1|ID, data = demo_debris)
anova(lme.vmax.svl.d)  #p-value =0.1832, insignificant
shapiro.test(residuals(lme.vmax.svl.d))  #normal
summary(lme.vmax.svl.d)

#SVL is insignificant on peak velocity for debris
```

```{r}
#Peak Velocity (mixed) vs SVL 
lme.vmax.svl.m <- lme(log10(top_velocity+1) ~ svl, random = ~1|ID, data = demo_mixed)
anova(lme.vmax.svl.m)  #p-value =0.6859, insignificant
shapiro.test(residuals(lme.vmax.svl.m))  #normal
summary(lme.vmax.svl.m)

#SVL is insignificant on peak velocity for mixed
```

```{r}
#Peak Velocity (sand) vs SVL 
lme.vmax.svl.s <- lme(log10(top_velocity+1) ~ svl, random = ~1|ID, data = demo_sand)
anova(lme.vmax.svl.s)  #p-value =0.4077, insignificant
shapiro.test(residuals(lme.vmax.svl.s))  #p=0.045
summary(lme.vmax.svl.s)

#SVL is insignificant on peak velocity for mixed
```


```{r}
#Peak Velocity (debris) vs tail 
lme.vmax.tail.d <- lme(log10(top_velocity+1) ~ tail_length, random = ~1|ID, data = demo_debris2)
anova(lme.vmax.tail.d)  #p-value =0.2838, insignificant
shapiro.test(residuals(lme.vmax.tail.d))  #normal
summary(lme.vmax.tail.d)

#tail is insignificant on peak velocity for debris
```

```{r}
#Peak Velocity (mixed) vs tail 
lme.vmax.tail.m <- lme(log10(top_velocity+1) ~ tail_length, random = ~1|ID, data = demo_mixed2)
anova(lme.vmax.tail.m)  #p-value =0.9034, insignificant
shapiro.test(residuals(lme.vmax.tail.m))  #normal
summary(lme.vmax.tail.m)

#tail is insignificant on peak velocity for mixed
```

```{r}
#Peak Velocity (sand) vs tail 
lme.vmax.tail.s <- lme(log10(top_velocity+1) ~ tail_length, random = ~1|ID, data = demo_sand2)
anova(lme.vmax.tail.s)  #p-value =0.9819, insignificant
shapiro.test(residuals(lme.vmax.tail.s))  #normal
summary(lme.vmax.tail.s)

#tail is insignificant on peak velocity for mixed
```


```{r}
#Acceleration vs Substrate Type + Bipedalism Combined
lme.amax.sub.biped <- lme(log10(side_amax+1) ~ substrate_type + biped_combined, random = ~1|ID, data = lab_data2)
anova(lme.amax.sub.biped)  #p-value substrate & sex = not significant
ggplot(lab_data2, aes(residuals(lme.amax.sub.biped))) + 
  geom_histogram(bins = 8, color = "white") +
  labs(x = "Residuals of lme.amax.sub.biped") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.amax.sub.biped))  #normal
summary(lme.amax.sub.biped)
performance::r2(lme.amax.sub.biped)   #C=0.047  #M=0.002
lme.amax.sub.biped.tukey <- emmeans(lme.amax.sub.biped, pairwise ~ substrate_type, adjust="tukey", data=lab_data2)
lme.amax.sub.biped.tukey  #no significant differences in any substrate's acceleration

ggplot(lab_data2, aes(y=side_amax, x=substrate_type, fill = biped_combined)) +
  geom_boxplot() + 
  scale_fill_discrete(labels = c("bipedal", "quadrupedal")) +
  labs(x = "Substrate", y = bquote('Peak Acceleration' ~ (m/s^2))) +
  scale_x_discrete(labels = c("Debris", "Sand", "Mixed")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black")) +
  theme(axis.line.x = element_line(color = "black", size = 0.5),
        axis.line.y = element_line(color = "black", size = 0.5),
        axis.text = element_text(face = "bold"),
        legend.title = element_blank())
```



```{r}
fieldspeed_reduced_debris <- read.csv("fieldspeed_reduced_debris.csv")
#same as fieldspeed_reduced except 2 debris points were removed for ground clutter analysis because by definition, debris substrates were completely made up of obstacles

#Speed vs. Number Clutter
mcelroy_speed_clutter_lme_log4 <- lme(log(Speed+1) ~ log10(NumberClutter+1), random = ~1|ID, data = fieldspeed_reduced_debris, na.action = na.omit)
anova(mcelroy_speed_clutter_lme_log4)  #p-value=0.0276, significant
shapiro.test(residuals(mcelroy_speed_clutter_lme_log4))  #normal
hist(residuals(mcelroy_speed_clutter_lme_log4))
performance::r2(mcelroy_speed_clutter_lme_log4)  #ok  #C=0.145   #M=0.145
summary(mcelroy_speed_clutter_lme_log4)

#log-log plot
ggplot(fieldspeed_reduced_debris, aes(log(NumberClutter+1), log(Speed+1)))+
  geom_point(aes(color = fieldspeed_reduced_debris$Substrate.Type)) + 
  geom_smooth(method = 'lm') +
  #labs(x = "Ground Clutter Crossed", y = "Speed (m/s)") +
  scale_color_discrete(name = "Substrate Type", labels = c("Mixed", "Sand")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"),
        axis.text = element_text(face = "bold"))

#non-transformed plot
ggplot(fieldspeed_reduced_debris, aes(NumberClutter, Speed))+
  geom_point(aes(color = fieldspeed_reduced_debris$Substrate.Type)) + 
  geom_smooth(method = 'lm') +
  #labs(x = "Ground Clutter Crossed", y = "Speed (m/s)") +
  scale_color_discrete(name = "Substrate Type", labels = c("Mixed", "Sand")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"),
        axis.text = element_text(face = "bold"))

#signficant relationship between speed and ground clutter crossed 
```


> Demographics: SVL, tail length

```{r}
#Checking for normality of data: max accelerations and velocities

#histograms
ggplot(data = demo, aes(top_acc))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Top Acceleration")   
ggplot(data = demo, aes(top_velocity))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Top Velocity") 

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(demo$top_acc)  #normal
shapiro.test(demo$top_velocity)  #normal
shapiro.test(demo_debris$top_acc)  #normal
shapiro.test(demo_debris$top_velocity)  #normal
shapiro.test(demo_mixed$top_acc)  #normal
shapiro.test(demo_mixed$top_velocity)  #normal
shapiro.test(demo_sand$top_acc)  #normal
shapiro.test(demo_sand$top_velocity)  #normal
```

#SVL

```{r}
#Debris - SVL vs. acceleration
lm(demo_debris$top_acc ~ demo_debris$svl)  #p=0.041, significant
debris.svl.acc <- lme(top_acc ~ svl, random = ~1|ID, data = demo_debris)
anova(debris.svl.acc)  
hist(residuals(debris.svl.acc))
shapiro.test(residuals(debris.svl.acc))  
summary(debris.svl.acc)
performance::r2(debris.svl.acc)  
```

```{r}
#Mixed - SVL vs. acceleration
lm(demo_mixed$top_acc ~ demo_mixed$svl)   
mixed.svl.acc <- lme(top_acc ~ svl, random = ~1|ID, data = demo_mixed)  #p=0.5863, not significant
anova(mixed.svl.acc)  
hist(residuals(mixed.svl.acc))
shapiro.test(residuals(mixed.svl.acc))  
summary(mixed.svl.acc)
performance::r2(mixed.svl.acc)  
```

```{r}
#Sand - SVL vs. acceleration
lm(demo_sand$top_acc ~ demo_sand$svl)  
sand.svl.acc <- lme(top_acc ~ svl, random = ~1|ID, data = demo_sand)  #p=0.4619, not significant
anova(sand.svl.acc)  
hist(residuals(sand.svl.acc))
shapiro.test(residuals(sand.svl.acc))  
summary(sand.svl.acc)
performance::r2(sand.svl.acc)  
```


```{r}
#Debris - SVL vs. velocity
lm(demo_debris$top_velocity ~ demo_debris$top_velocity)  
debris.svl.vel <- lme(top_velocity ~ svl, random = ~1|ID, data = demo_debris)  #p=0.1968, not significant
anova(debris.svl.vel)  
hist(residuals(debris.svl.vel))
shapiro.test(residuals(debris.svl.vel))  
summary(debris.svl.vel)
performance::r2(debris.svl.vel)  
```

```{r}
#Mixed - SVL vs. velocity
lm(demo_mixed$top_velocity ~ demo_mixed$top_velocity)  
mixed.svl.vel <- lme(top_velocity ~ svl, random = ~1|ID, data = demo_mixed)  #p=0.6829, not significant
anova(mixed.svl.vel)  
hist(residuals(mixed.svl.vel))
shapiro.test(residuals(mixed.svl.vel))  #normal
summary(mixed.svl.vel)
performance::r2(mixed.svl.vel)  
```

```{r}
#Sand - SVL vs. velocity
lm(demo_sand$top_velocity ~ demo_sand$top_velocity)  
sand.svl.vel <- lme(top_velocity ~ svl, random = ~1|ID, data = demo_sand)  #p=0.3959, not significant
anova(sand.svl.vel)  
hist(residuals(sand.svl.vel))
shapiro.test(residuals(sand.svl.vel))  
summary(sand.svl.vel)
performance::r2(sand.svl.vel)  
```

#Tail Length

```{r}
#Debris - TL vs. acceleration
lm(demo_debris2$top_acc ~ demo_debris2$tail_length)  
debris.tl.acc <- lme(top_acc ~ tail_length, random = ~1|ID, data = demo_debris2)  #p=0.443, not significant
anova(debris.tl.acc)  
hist(residuals(debris.tl.acc))
shapiro.test(residuals(debris.tl.acc))  
summary(debris.tl.acc)
performance::r2(debris.tl.acc)  
```

```{r}
#Mixed - tl vs. acceleration
lm(demo_mixed2$top_acc ~ demo_mixed2$tail_length)   
mixed.tl.acc <- lme(top_acc ~ tail_length, random = ~1|ID, data = demo_mixed2)  #p=0.4193, not significant
anova(mixed.tl.acc)  
hist(residuals(mixed.tl.acc))
shapiro.test(residuals(mixed.tl.acc))  
summary(mixed.tl.acc)
performance::r2(mixed.tl.acc)  

#the only one that is significant; tail length significantly effects top acceleration on mixed 
```

```{r}
#Sand - tl vs. acceleration
lm(demo_sand2$top_acc ~ demo_sand2$tail_length)  
sand.tl.acc <- lme(top_acc ~ tail_length, random = ~1|ID, data = demo_sand2)  #p=0.6829, not significant
anova(sand.tl.acc)  
hist(residuals(sand.tl.acc))
shapiro.test(residuals(sand.tl.acc))  
summary(sand.tl.acc)
performance::r2(sand.tl.acc)  
```


```{r}
#Debris - tl vs. velocity
lm(demo_debris2$top_velocity ~ demo_debris2$top_velocity)  
debris.tl.vel <- lme(top_velocity ~ tail_length, random = ~1|ID, data = demo_debris2)  #p=0.2924, not significant
anova(debris.tl.vel)  
hist(residuals(debris.tl.vel))
shapiro.test(residuals(debris.tl.vel))  
summary(debris.tl.vel)
performance::r2(debris.tl.vel)  
```

```{r}
#Mixed - tl vs. velocity
lm(demo_mixed2$top_velocity ~ demo_mixed2$top_velocity)  
mixed.tl.vel <- lme(top_velocity ~ tail_length, random = ~1|ID, data = demo_mixed2)  #p=0.8614, not significant
anova(mixed.tl.vel)  
hist(residuals(mixed.tl.vel))
shapiro.test(residuals(mixed.tl.vel))  #normal
summary(mixed.tl.vel)
performance::r2(mixed.tl.vel)  
```

```{r}
#Sand - tl vs. velocity
lm(demo_sand2$top_velocity ~ demo_sand2$top_velocity)  
sand.tl.vel <- lme(top_velocity ~ tail_length, random = ~1|ID, data = demo_sand2)  #p=0.9727, not significant
anova(sand.tl.vel)  
hist(residuals(sand.tl.vel))
shapiro.test(residuals(sand.tl.vel))  
summary(sand.tl.vel)
performance::r2(sand.tl.vel)  
```


> Analysis of biped during first 10% and last 10% of runs

```{r}
biped_10 <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_2.19.21_biped_first_last_10%.csv")
#digitized videos data with whether the lizards were bipedal in the first and last 10% of frames of their trials
```

```{r}
lme.amax.sub.biped1 <- lme(log10(side_amax+1) ~ substrate_type, random = ~1|ID, data = biped_10)
anova(lme.amax.sub.biped1)  #p-value substrate & sex = not significant
ggplot(biped_10, aes(residuals(lme.amax.sub.biped1))) + 
  geom_histogram(bins = 8, color = "white") +
  labs(x = "Residuals of lme.amax.sub.biped") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line = element_line(color = "black"))
shapiro.test(residuals(lme.amax.sub.biped1))  #normal
summary(lme.amax.sub.biped1)
performance::r2(lme.amax.sub.biped1)   #C=0.047  #M=0.002
lme.amax.sub.biped.tukey <- emmeans(lme.amax.sub.biped1, pairwise ~ substrate_type, adjust="tukey", data=biped_10)
lme.amax.sub.biped.tukey 
```

```{r}
ggplot(biped_10, aes(y=side_amax, x=substrate_type, fill = bipedal_first_0.10)) +
  geom_boxplot() 

ggplot(biped_10, aes(y=side_vmax, x=substrate_type, fill = bipedal_first_0.10)) +
  geom_boxplot() 

ggplot(biped_10, aes(y=side_amax, x=substrate_type, fill = bipedal_last_0.10)) +
  geom_boxplot() 

ggplot(biped_10, aes(y=side_vmax, x=substrate_type, fill = bipedal_last_0.10)) +
  geom_boxplot() 
```


```{r}
mcelroy_speed_sex <- lme(log10(Speed) ~ Sex, random = ~1|ID, data = fieldspeed_jan, na.action=na.omit)
anova(mcelroy_speed_sex)
```


> Finding Effect Size

```{r}
#library(esc)
library(lsr)
```

```{r}
cohensD(lab_data2$peak_v[lab_data2$biped_combined=="B"], lab_data2$peak_v[lab_data2$biped_combined=="Q"])  #1.379734   
  #small effect size - small stregnth of association between variables
 
cohensD(lab_data2$side_amax[lab_data2$biped_combined=="B"], lab_data2$side_amax[lab_data2$biped_combined=="Q"])  #0.1976821    
  #large effect size - large strength of association between variables
```

```{r}
#trying to figure out Speed~NumberClutter issues
fieldspeed_reduced_debris2 <- read.csv("~/College of Charleston/Thesis/Data/McElroy Habitat Data/fieldspeed_reduced_debris2.csv")

mcelroy_speed_clutter_lme_log5 <- lme(log(Speed+1) ~ log10(NumberClutter+1), random = ~1|ID, data = fieldspeed_reduced_debris2, na.action = na.omit)
anova(mcelroy_speed_clutter_lme_log5)  #p-value=0.127
shapiro.test(residuals(mcelroy_speed_clutter_lme_log5))  #normal
hist(residuals(mcelroy_speed_clutter_lme_log5))
performance::r2(mcelroy_speed_clutter_lme_log5)  
summary(mcelroy_speed_clutter_lme_log5)

model1 <- lm(Speed ~ NumberClutter, data = fieldspeed_reduced_debris2)
anova(model1)
summary(model1)  #p=0.246, insignificant
shapiro.test(residuals(model1))  #normal



model2 <- lm(log10.speed. ~ log.NumberClutter, data = fieldspeed_reduced_debris2)
anova(model2)
summary(model2)  #p=0.2103, insignificant
shapiro.test(residuals(model2))  #not normal

model3 <- lm(log10.speed. ~ log.numberClutter., data = fieldspeed_reduced_debris2)
anova(model3)
summary(model3)  #p=0.3427, insignificant
shapiro.test(residuals(model3))  #not normal


#Using lme model for log(speed) ~ log(ground clutter) produces a p-value of 0.127 and for some reason won't give me any R2 values. 
#I ran a ln of speed ~ ground clutter (non-logged) and it produced a p-value of 0.246, which is still insignificant. I tried logging both speed and ground clutter crossed in excel before putting it in a ln model but the data for both models was not normal. 
#In the lme log(speed) ~ substrate model the marginal and conditional R2 values are the same.
```



```{r}
lme1 <- lme(side_avg_v ~ substrate_type*biped_combined, random = ~1|ID, data = lab_data2_avg_v)  #un-transformed
shapiro.test(residuals(lme1))  #not normal
hist(residuals(lme1))

lme2 <- lme(sqrt(side_avg_v+1) ~ substrate_type*biped_combined, random = ~1|ID, data = lab_data2_avg_v)  #square root
shapiro.test(residuals(lme2))  #not normal
hist(residuals(lme2))

lme3 <- lme(log10(side_avg_v+1) ~ substrate_type*biped_combined, random = ~1|ID, data = lab_data2_avg_v)  #log
shapiro.test(residuals(lme3))  #not normal
hist(residuals(lme3))

lme4 <- lme(abs(side_avg_v+1)^(1/3) ~ substrate_type*biped_combined, random = ~1|ID, data = lab_data2_avg_v)  #cubed root
shapiro.test(residuals(lme4))  #not normal
hist(residuals(lme4))

lme6 <- lm(side_avg_v ~ substrate_type*biped_combined, data = lab_data2_avg_v)
shapiro.test(residuals(lme6))  #not normal
hist(residuals(lme6))
```


```{r}
lme1 <- lme(side_avg_v ~ substrate_type, random = ~1|ID, data = lab_data2_avg_v)  #un-transformed
shapiro.test(residuals(lme1))  #not normal
hist(residuals(lme1))

lme2 <- lme(sqrt(side_avg_v+1) ~ substrate_type, random = ~1|ID, data = lab_data2_avg_v)  #square root
shapiro.test(residuals(lme2))  #not normal
hist(residuals(lme2))

lme3 <- lme(log10(side_avg_v+1) ~ substrate_type, random = ~1|ID, data = lab_data2_avg_v)  #log
shapiro.test(residuals(lme3))  #not normal
hist(residuals(lme3))

lme4 <- lme(abs(side_avg_v+1)^(1/3) ~ substrate_type, random = ~1|ID, data = lab_data2_avg_v)  #cubed root
shapiro.test(residuals(lme4))  #not normal
hist(residuals(lme4))

lme6 <- lm(side_avg_v ~ substrate_type, data = lab_data2_avg_v)
shapiro.test(residuals(lme6))  #not normal
hist(residuals(lme6))
```


```{r}
lab_data2_avg_v_reduced <- read.csv("~/College of Charleston/Thesis/Data/lab_data2_avg_v_reduced.csv")
lab_data2_avg_v_side.reduced <- read.csv("~/College of Charleston/Thesis/Data/lab_data2_avg_v_side-reduced.csv")
lab_data2_avg_v_top.reduced <- read.csv("~/College of Charleston/Thesis/Data/lab_data2_avg_v_top-reduced.csv")

lme1 <- lme(side_avg_v ~ substrate_type, random = ~1|ID, data = lab_data2_avg_v_side.reduced)  #un-transformed
shapiro.test(residuals(lme1))  #not normal
hist(residuals(lme1))

lme2 <- lme(top_avg_v ~ substrate_type, random = ~1|ID, data = lab_data2_avg_v_top.reduced)  #un-transformed
shapiro.test(residuals(lme2))  #not normal
hist(residuals(lme1))
```



