---
title: "Lab_data_w/o_no-standstill_starts"
author: "Kayla Pehl"
date: "10/1/2020"
output: html_document
---

# This dataset does NOT include trials where the lizard did not start from a standstill

```{r}
#Importing data and required packages

data <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_final_10.01.20_removed_non-standstill_starts.csv")
library(ggplot2)
```

```{r}
#Side max acceleration max per substrate 

ggplot(data = data, aes(side_amax))  + 
  geom_histogram(fill="orange") +
  facet_wrap(~substrate_type) +
  labs(title = "Side max acceleration per substrate")


#Side max acceleration max per sex

ggplot(data = data, aes(side_amax))  + 
  geom_histogram(fill="orange") +
  facet_wrap(~sex) +
  labs(title = "Side max acceleration per sex")
```

```{r}
#Top max acceleration max per substrate 

ggplot(data = data, aes(top_amax))  + 
  geom_histogram(fill="purple") +
  facet_wrap(~substrate_type) +
  labs(title = "Top max acceleration per substrate")


#Top max acceleration max per sex

ggplot(data = data, aes(top_amax))  + 
  geom_histogram(fill="purple") +
  facet_wrap(~sex) +
  labs(title = "Top max acceleration per sex")
```


```{r}
#Bipedalism percentage per sex Histogram
ggplot(data = data, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="green", bins = 20, binwidth = 10) +
  facet_wrap(~sex)

#Bipedalism percentage per substrate Histogram
ggplot(data = data, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="green", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type)
```


```{r}
#Boxplots of Bipedalism on acceleration 

ggplot(data = data, aes(x=bipedal_quad_side, y=side_amax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max acceleration (side)")

ggplot(data = data, aes(x=bipedal_quad_top, y=top_amax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max acceleration (top)")

#Boxplots of Bipedalism on velocity

ggplot(data = data, aes(x=bipedal_quad_side, y=side_vmax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max velocity (side)")

ggplot(data = data, aes(x=bipedal_quad_top, y=top_vmax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max velocity (top)")
```

```{r}
table(data$bipedal_quad_side)
table(data$bipedal_quad_top)
```


```{r}
#Summary of data
summary(data)
```

```{r}
summary(lm(side_amax~sex, data = data))
```

```{r}
#Checking for normality of data: max accelerations and velocities

#historgrams
ggplot(data = data, aes(side_amax))  + 
  geom_histogram(bins = 11, col = ("grey"))

ggplot(data = data, aes(top_amax))  + 
  geom_histogram(bins = 11, col = ("grey"))

ggplot(data = data, aes(side_vmax))  + 
  geom_histogram(bins = 13, col = ("grey"))

ggplot(data = data, aes(top_vmax))  + 
  geom_histogram(bins = 11, col = ("grey"))

#Shapiro-Wilks normality test (p-value <0.05 is normal)
shapiro.test(data$side_amax)
shapiro.test((data$top_amax))
shapiro.test((data$side_vmax))
shapiro.test(data$top_vmax)

#side_amax: normal
#top_amax: normal
#side_vmax: not normal
#top_vmax: not normal
```


```{r}
#Checking for normality of data: time and position

#historgrams
ggplot(data = data, aes(side_tmax))  + 
  geom_histogram(bins = 11, col = ("grey"))

ggplot(data = data, aes(top_tmax))  + 
  geom_histogram(bins = 11, col = ("grey"))

ggplot(data = data, aes(side_posmax))  + 
  geom_histogram(bins = 13, col = ("grey"))

ggplot(data = data, aes(top_posmax))  + 
  geom_histogram(bins = 11, col = ("grey"))

#Shapiro-Wilks normality test (p-value <0.05 is normal)
shapiro.test(data$side_tmax)
shapiro.test((data$top_tmax))
shapiro.test((data$side_posmax))
shapiro.test(data$top_posmax)

#side_tmax: normal
#top_tmax: normal
#side_posmax: not normal
#top_posmax: normal
```


```{r}
top.amax.biped <- lm(top_amax ~ bipedal_top, data = data)
res.top.amax.biped <- resid(top.amax.biped)
plot(fitted(top.amax.biped), res.top.amax.biped)
abline(0,0)

qqnorm(res.top.amax.biped)
qqline(res.top.amax.biped)
plot(density(res.top.amax.biped))
```







