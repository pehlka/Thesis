---
title: "Lab_data_w/o_no-standstill_starts"
author: "Kayla Pehl"
date: "10/1/2020"
output: html_document
---

# This dataset does NOT include trials where the lizard did not start from a standstill

```{r}
#Importing data and required packages

lab.data <- read.csv("~/College of Charleston/Thesis/Videos Digitized/Thesis_videos_digitized_condensed_final_10.15.20_removed_non-standstill_starts+NAs+negatives.csv")

#Creating new data frame without N/A's in bipedal percent column    
##148 rows in lab.data and 88 rows in lab.data_omit, so 60 trials didn't contain bipedalism but 88 did 
lab.data_omit <- lab.data[!is.na(lab.data$bipedal_percent), ]

library(ggplot2)
library(rcompanion)
library(lme4)
library(sjstats)
library(doBy)
library(car)
```

```{r}
#Checking to see if all data is in correct formats (i.e. factor vs. numeric)    

is.factor(lab.data$ID)
is.factor(lab.data$sex)
is.factor(lab.data$substrate_type)
is.numeric(lab.data$pauses_side)
is.numeric(lab.data$pauses_top)
is.factor(lab.data$bipedal_quad_side)
is.factor(lab.data$bipedal_quad_top)
is.numeric(lab.data$bipedal_side)
is.numeric(lab.data$bipedal_top)
is.numeric(lab.data$total_video_frames)
is.numeric(lab.data$bipedal_percent)
is.factor(lab.data$no_start_from_standstill)
is.factor(lab.data$stops_before_end_of_racetrack)
is.numeric(lab.data$calibration)
is.numeric(lab.data$side_amax)
is.numeric(lab.data$side_pmax)
is.numeric(lab.data$side_posmax)
is.numeric(lab.data$side_spline_tol)
is.numeric(lab.data$side_tmax)
is.numeric(lab.data$side_vmax)
is.numeric(lab.data$top_amax)
is.numeric(lab.data$top_pmax)
is.numeric(lab.data$top_posmax)
is.numeric(lab.data$top_spline_tol)
is.numeric(lab.data$top_tmax)
is.numeric(lab.data$top_vmax)

#All are correct. Therefore nothing in dataset needs to change.
```


#Getting a feel for the data

```{r}
#Summary of data
summary(lab.data)
```

```{r}
#Number of Pauses
table(lab.data$pauses_side)
table(lab.data$pauses_top)
```
```{r}
#Runs per lizard on each substrate type
table(lab.data$ID, lab.data$substrate_type)

#using this data set (without no-standstill starts), lizard F has no runs for D or s, lizard N has no runs for D, and lizard P has no runs for D; all other lizards have at least 1 run for each of the substrates
```
> should this impact the dataset I use? (not using no-standstill starts currently)?
>> Eric said to do data work up using these 3 lizards and then when I'm done I'll need to go back and run stats without the 3 lizards and then compare the results; if the results are the same, we can run the stats including the 3 lizards, if not, we'll have to decide how to proceed


```{r}
#Females vs males count
table(lab.data$sex)

#70% runs are female, 30% are male
```



> Creating histograms to see distribution of data

#Max acceleration
```{r}
#Side max acceleration per substrate 
ggplot(data = lab.data, aes(side_amax))  + 
  geom_histogram(fill="orange", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Side max acceleration per substrate")

#mean, median & range of side_amax data separated into substrate types
summaryBy(side_amax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Side max acceleration per sex
ggplot(data = lab.data, aes(side_amax))  + 
  geom_histogram(fill="orange", bins = 20, binwidth = 5) +
  facet_wrap(~sex) +
  labs(title = "Side max acceleration per sex")

#mean, median & range of side max acceleration separated into sex
summaryBy(side_amax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max acceleration per substrate 
ggplot(data = lab.data, aes(top_amax))  + 
  geom_histogram(fill="purple", bins = 30, binwidth = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Top max acceleration per substrate")

#mean, median & range of top max acceleration separated into substrate types
summaryBy(top_amax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max acceleration per sex
ggplot(data = lab.data, aes(top_amax))  + 
  geom_histogram(fill="purple", bins = 30, binwidth = 5) +
  facet_wrap(~sex) +
  labs(title = "Top max acceleration per sex")

#mean, median & range of top max acceleration separated into sex
summaryBy(top_amax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```


#Max velocity
```{r}
#Side max velocity per substrate 
ggplot(data = lab.data, aes(side_vmax))  + 
  geom_histogram(fill="orange", bins = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Side max velocity per substrate")

#mean, median & range of side_vmax data separated into substrate types
summaryBy(side_vmax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Side max velocity per sex
ggplot(data = lab.data, aes(side_vmax))  + 
  geom_histogram(fill="orange", bins = 10) +
  facet_wrap(~sex) +
  labs(title = "Side max velocity per sex")

#mean, median & range of side vmax velocity separated into sex
summaryBy(side_vmax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max velocity per substrate 
ggplot(data = lab.data, aes(top_vmax))  + 
  geom_histogram(fill="purple", bins = 10) +
  facet_wrap(~substrate_type) +
  labs(title = "Top max velocity per substrate")

#mean, median & range of top max velocity separated into substrate types
summaryBy(top_vmax ~ substrate_type, data = lab.data,
          FUN = list(mean, median, min, max))
```

```{r}
#Top max velocity per sex
ggplot(data = lab.data, aes(top_vmax))  + 
  geom_histogram(fill="purple", bins = 10) +
  facet_wrap(~sex) +
  labs(title = "Top max velocity per sex")

#mean, median & range of top max velocity separated into sex
summaryBy(top_vmax ~ sex, data = lab.data,
          FUN = list(mean, median, min, max))
```



#Bipedalism Percentage
```{r}
#Bipedalism percentage per sex Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~sex)

#mean, median & range of bipedal percentage separated into sex
summaryBy(bipedal_percent ~ sex, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#males are bipedal a lot more than females
```

```{r}
#Bipedalism percentage per substrate Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type)

summaryBy(bipedal_percent ~ substrate_type, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#lizards are a lot more likely to run bipedal on debris than sand
```


```{r}
#Bipedalism percentage per substrate and sex Histogram
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent)))  + 
  geom_histogram(fill="dark green", bins = 20, binwidth = 10) +
  facet_wrap(~substrate_type + sex) +
  facet_grid(sex ~ substrate_type)

#mean, median & range of bipedal percentage separated into substrate type
summaryBy(bipedal_percent ~ substrate_type + sex, data = lab.data_omit,
          FUN = list(mean, median, min, max))

#males are bipedal more often on every substrate than females

##for final manuscript, change plot titles to actual names instead of letters
### https://www.zevross.com/blog/2019/04/02/easy-multi-panel-plots-in-r-using-facet_wrap-and-facet_grid-from-ggplot2/ 
```


```{r}
#Boxplots of Bipedalism on acceleration 

ggplot(data = lab.data, aes(x=bipedal_quad_side, y=side_amax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max acceleration (side)")

ggplot(data = lab.data, aes(x=bipedal_quad_top, y=top_amax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max acceleration (top)")
```

```{r}
#Boxplots of Bipedalism on velocity

ggplot(data = lab.data, aes(x=bipedal_quad_side, y=side_vmax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max velocity (side)")

ggplot(data = lab.data, aes(x=bipedal_quad_top, y=top_vmax)) +
  geom_boxplot() +
    labs(title = "Bipedalism effect on max velocity (top)")
```


#Pmax, Posmax, Tmax
```{r}
#Histograms of pmax, posmax and tmax
ggplot(data = lab.data, aes(side_pmax)) +
  geom_histogram(fill = "dark blue") +
    labs(title = "Side Pmax")                     #skewed right

ggplot(data = lab.data, aes(side_posmax)) +
  geom_histogram(fill = "dark blue") +
    labs(title = "Side Posmax")                   #skewed left

ggplot(data = lab.data, aes(side_tmax)) +
  geom_histogram(fill = "dark blue") +
    labs(title = "Side Tmax")

ggplot(data = lab.data, aes(top_pmax)) +
  geom_histogram(fill = "medium blue") +
    labs(title = "Top Pmax")                      #skewed right

ggplot(data = lab.data, aes(top_posmax)) +
  geom_histogram(fill = "medium blue") +
    labs(title = "Top Posmax")

ggplot(data = lab.data, aes(top_tmax)) +
  geom_histogram(fill = "medium blue") +
    labs(title = "Top Tmax")                      #skewed right
```

```{r}
#Looking at bipedal vs. quadrupedal percentages from side and top

table(lab.data$bipedal_quad_side)
#42.6% bipedal on side runs, 57.4% quadrupedal on side runs

table(lab.data$bipedal_quad_top)
#53.3% bipedal on top runs, 46.7% quadrupedal on top runs
```


# Checking for normality

```{r}
#Checking for normality of data: max accelerations and velocities

#histograms
ggplot(data = lab.data, aes(side_amax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Side Amax")                        #looks pretty normal

ggplot(data = lab.data, aes(top_amax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Top Amax")                         #looks skewed right

ggplot(data = lab.data, aes(side_vmax))  + 
  geom_histogram(bins = 13, col = ("grey")) +
  labs(title = "Side Vmax")                        #looks fairly normal

ggplot(data = lab.data, aes(top_vmax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Top Vmax")                         #looks skewed left

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(lab.data$side_amax)
shapiro.test((lab.data$top_amax))
shapiro.test((lab.data$side_vmax))
shapiro.test(lab.data$top_vmax)

#side_amax: not normal
#top_amax: not normal
#side_vmax: normal
#top_vmax: normal
```

```{r}
#Checking for normality of data: time and position

#histograms
ggplot(data = lab.data, aes(side_tmax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
  labs(title = "Side Tmax")                           #looks skewed right

ggplot(data = lab.data, aes(top_tmax))  + 
  geom_histogram(bins = 11, col = ("grey")) +
    labs(title = "Top Tmax")                          #looks skewed right

ggplot(data = lab.data, aes(side_posmax))  + 
  geom_histogram(bins = 13, col = ("grey")) +
    labs(title = "Side Posmax")                       #looks fairly normal

ggplot(data = lab.data, aes(top_posmax))  + 
  geom_histogram(bins = 30, col = ("grey")) +
    labs(title = "Top Posmax")

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(lab.data$side_tmax)
shapiro.test((lab.data$top_tmax))
shapiro.test((lab.data$side_posmax))
shapiro.test(lab.data$top_posmax)

#side_tmax: not normal
#top_tmax: not normal
#side_posmax: normal
#top_posmax: not normal
```

```{r}
#Checking for normality of data: bipedal_side and bipedal_top

#histograms
ggplot(data = lab.data_omit, aes(bipedal_side))  + 
  geom_histogram(bins = 20, col = ("grey"))

ggplot(data = lab.data, aes(bipedal_top))  + 
  geom_histogram(bins = 20, col = ("grey"))

#Shapiro-Wilks normality test (p-value >0.05 assumes normality)
shapiro.test(lab.data$bipedal_side)
shapiro.test((lab.data$bipedal_top))

#bipedal_side: normal
#bipedal_top: not normal
```



> Looking at diagnostics data

```{r}
#Top max acceleration vs. bipedalism in top

top.amax.biped <- lm(top_amax ~ bipedal_top, data = lab.data)
res.top.amax.biped <- resid(top.amax.biped)
plot(fitted(top.amax.biped), res.top.amax.biped)
abline(0,0)

qqnorm(res.top.amax.biped)
qqline(res.top.amax.biped,
       col = 'red')
plot(density(res.top.amax.biped))

plot(top.amax.biped)

#QQ plot shows data is skewed left -- need to transform

# > Do I need to do anything with the other plots?
```

```{r}
#Side camera max acceleration vs. bipedalism in side
side.amax.biped <- lm(side_amax ~ bipedal_side, data = lab.data)
res.side.amax.biped <- resid(side.amax.biped)
plot(fitted(side.amax.biped), res.side.amax.biped)

qqnorm(res.side.amax.biped)
qqline(res.side.amax.biped,
       col = 'red')
plot(density(res.side.amax.biped))

plot(side.amax.biped)

#QQ plot maybe slightly skewed left - need to transform
```

```{r}
#Top max velocity vs. bipedalism in top
top.vmax.biped <- lm(top_vmax ~ bipedal_top, data = lab.data)
res.top.vmax.biped <- resid(top.vmax.biped)
plot(fitted(top.vmax.biped), res.top.vmax.biped)

qqnorm(res.top.vmax.biped)
qqline(res.top.vmax.biped,
       col = 'red')
plot(density(res.top.vmax.biped))

plot(top.vmax.biped)

#QQ plot maybe slightly skewed left but it looks pretty close to normal
```

```{r}
#Side max velocity vs. bipedalism in side
side.vmax.biped <- lm(side_vmax ~ bipedal_side, data = lab.data)
res.side.vmax.biped <- resid(side.vmax.biped)
plot(fitted(side.vmax.biped), res.side.vmax.biped)

qqnorm(res.side.vmax.biped)
qqline(res.side.vmax.biped,
       col = 'red')
plot(density(res.side.vmax.biped))

plot(side.vmax.biped)

#QQ plot looks pretty close to normal 
```


#Trying to determine if v_max needs to be transformed or not

```{r}
#Log transform side max velocity vs. bipedalism in side

log_side_vmax <- log(lab.data$side_vmax)
log.side.vmax.biped <- lm(log_side_vmax ~ bipedal_side, data = lab.data)
res.log.side.vmax.biped <- resid(log.side.vmax.biped)
plot(fitted(log.side.vmax.biped), res.log.side.vmax.biped)

shapiro.test(res.log.side.vmax.biped)
hist(log_side_vmax)

qqnorm(res.log.side.vmax.biped)
qqline(res.log.side.vmax.biped,
       col = 'red')
plot(density(res.log.side.vmax.biped))  #QQ plot looks pretty close to normal

plot(log.side.vmax.biped)

ggplot(data = lab.data, aes(log_side_vmax))  + 
  geom_histogram(bins = 13, col = ("grey"))    #skewed left

plot(lm(side_vmax ~ bipedal_side, data = lab.data))  #Side vmax vs. bipedalism

#Q-Q plots of regular and log-transformed side vmax data look basically the same to me. I'm not sure if log-transforming did a lot for the data.
```


```{r}
# Added this section during meeting with Eric

#log transform each variable!
#probably need to log transform all variables and then check residuals
#levene's test

log_side_amax <- log10(lab.data$side_amax+1)
log.side.amax.biped <- lm(log_side_amax ~ bipedal_side, data = lab.data)
res.log.side.amax.biped <- resid(log.side.amax.biped)
plot(fitted(log.side.amax.biped), res.log.side.amax.biped)


shapiro.test(res.log.side.amax.biped)
hist(res.log.side.amax.biped)

leveneTest(log_side_amax, lab.data$bipedal_side)
```

```{r}
#Comparing side vmax data from original with log-transformed

#histograms
plotNormalHistogram(lab.data$side_vmax)  #appears pretty symmetrical 
plotNormalHistogram(log_side_vmax)  #skew left

#Shapiro-Wilks test for normality
shapiro.test(lab.data$side_vmax)  #normal -- not transformed
shapiro.test(log_side_vmax)  #not normal -- log transformed
```

```{r}
#Log transform top max velocity vs. bipedalism in top

log_top_vmax <- log(lab.data$top_vmax)
log.top.vmax.biped <- lm(log_top_vmax ~ bipedal_top, data = lab.data)
res.log.top.vmax.biped <- resid(log.top.vmax.biped)
plot(fitted(log.top.vmax.biped), res.log.top.vmax.biped)  

qqnorm(res.log.top.vmax.biped)
qqline(res.log.top.vmax.biped,
       col = 'red')
plot(density(res.log.top.vmax.biped))  #QQ plot looks pretty close to normal

plot(log.top.vmax.biped)

plot(lm(top_vmax ~ bipedal_top, data = lab.data))  #not transformed  #QQ plot is skewed left
```

```{r}
#Comparing top vmax data from original with log-transformed

#histograms
plotNormalHistogram(lab.data$top_vmax)  #appears pretty symmetrical 
plotNormalHistogram(log_top_vmax)  #skew left

#Shapiro-Wilks test for normality
shapiro.test(lab.data$top_vmax)  #normal -- no transformation
shapiro.test(log_top_vmax)  #not normal  -- log transformed
```

```{r}
#Trying to determine if bipedal_top needs to be transformed              DELETE! UNNECESSARY!

#Shapiro-Wilk test
shapiro.test(lab.data$bipedal_top)          #normal

#Non-transformed
plotNormalHistogram(as.numeric(lab.data$bipedal_top), main = "Non-transformed")  #skewed left

#Squared
top.dat <- as.numeric(lab.data$bipedal_top)
top.square <- top.dat^2
plotNormalHistogram(top.square, main = "Bipedal_top Squared")  #even more skewed left than regular bipedal_top

#Exponential
top.exp <- exp(top.dat)
plotNormalHistogram(top.exp, main = "Exponential")   #even more un-normal than non-transformed

#Reciprocal 
top.rec <- 1/top.dat
plotNormalHistogram(top.rec, main = "Reciprocal")  #made bipedal_top skewed right and it's even worse than non-transformed

#Bipedal_top looks best non-transformed
```



```{r}
#Tukey Test (attempt)

anova_top_vmax <- anova(lm(top_vmax ~ sex, data = lab.data))
anova_top_vmax
#since p<0.5 there is enough evidence to conclude that the mean values across both sexes aren't equal & can run a Tukey test

TukeyHSD(x = anova_top_vmax, conf.level = 0.95)
#can't get Tukey test to work
```


# Linear Models with Interaction Effects

```{r}
#Velocity

anova(lm(top_vmax ~ sex*bipedal_top*substrate_type*ID, data=lab.data))
#sex, bipedal_top & substrate type are all significant by themselves

anova(lm(side_vmax ~ sex*bipedal_side*substrate_type*ID, data = lab.data))
#sex and bipedalism were very significant by themselves
#ID was also significant by itself
```

```{r}
#Acceleration

anova(lm(top_amax ~ sex*bipedal_top*substrate_type*ID, data = lab.data))
#nothing is significant

anova(lm(side_amax ~ sex*bipedal_side*substrate_type*ID, data = lab.data))
#nothing is significant
```


# Bipedal Percentage

```{r}
#Bipedal Percentage Plots

#Histogram of bipedal percent without N/A's broken into sex
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=sex, fill=sex)) +
  geom_histogram(col = "white") + 
  labs(title = "Histogram of Bipedal Percent (without N/As) Broken Down by Sex")

#Histogram of bipedal percent without N/A's separated into substrate type
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type)) +
  geom_histogram(bins = 20, binwidth = 8) +
  facet_wrap(~substrate_type) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Separated by Substrate Type")

#Histogram of bipedal percent without NA's separated into substrate type and sex
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type, alpha=sex)) +
  geom_histogram(bins = 20, binwidth = 8) +
  facet_wrap(~substrate_type) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Separated by Substrate Type and Sex")

#Histogram of bipedal percent without N/A's broken into substrate type
ggplot(data = lab.data_omit, aes(as.numeric(bipedal_percent), col=substrate_type, fill=substrate_type)) +
  geom_histogram(bins = 20, binwidth = 8) +
  labs(title = "Histogram of Bipedal Percent (without N/As) Broken into Substrate Type")

#Boxplot of bipedal percent without N/A's separated by substrate type
ggplot(data = lab.data_omit, aes(substrate_type, as.numeric(bipedal_percent))) +
  geom_boxplot() + 
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Substrate Type")

#Boxplot of bipedal percent without N/A's separated by sex
ggplot(data = lab.data_omit, aes(sex, as.numeric(bipedal_percent))) +
  geom_boxplot() + 
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Sex")

#Boxplot of bipedal percent without N/A's separated by substrate type and sex
ggplot(data = lab.data_omit, aes(substrate_type, as.numeric(bipedal_percent), fill = sex)) +
  geom_boxplot() +
  labs(title = "Boxplot of Bipedal Percent (without N/As) by Substrate Type and Sex")


#Lizards are running bipedal the most on debris compared to the other substrate types.
#Based on the boxplot, lizards are treating bipedalism on sand/debris as more similar to sand than debris
#Males run bipedally more frequently than females for all substrate types
```


```{r}
#Percent bipedal vs. substrate types and sex linear models
summary(lm(as.numeric(bipedal_percent) ~ substrate_type*sex, data = lab.data_omit))
anova((lm(as.numeric(bipedal_percent) ~ substrate_type*sex, data = lab.data_omit)))

#Neither substrate type nor sex is significantly effecting bipedalism according to the models
```

```{r}
#Mixed model bipedal percent and substrate type
lmer2<-lmer(bipedal_percent ~ substrate_type + (1 | ID), data = lab.data_omit)
summary(lmer(bipedal_percent ~ substrate_type + (1 | ID), data = lab.data_omit))
Anova(lmer2)     
#sand and sand/debris have significant p-values
```

```{r}
#Mixed model bipedal percent and sex
lmer(bipedal_percent ~ sex + (1 | ID), data = lab.data_omit)
summary(lmer(bipedal_percent ~ sex + (1 | ID), data = lab.data_omit))
```

```{r}
#Mixed model bipedal percent and substrate type + sex
lmer1<-lmer(bipedal_percent ~ sex*substrate_type + (1 | ID), data = lab.data_omit)
summary(lmer(bipedal_percent ~ sex*substrate_type + (1 | ID), data = lab.data_omit))

#no interaction effects are significant
```



> Checking assumptions: normality of residuals
##all residuals should be log transformed

```{r}
#Log transforming all variables 
##included log10 and +1 because it forces 0's to be 0's and not something else

log_side_amax <- log10(lab.data$side_amax +1)
log_top_amax <- log10(lab.data$top_amax +1)
log_side_vmax <- log10(lab.data$side_vmax +1)
log_top_vmax <- log10(lab.data$top_vmax +1)
log_side_posmax <- log10(lab.data$side_posmax +1)
log_top_posmax <- log10(lab.data$top_posmax +1)
log_side_tmax <- log10(lab.data$side_tmax +1)
log_top_tmax <- log10(lab.data$top_tmax +1)
log_side_pmax <- log10(lab.data$side_pmax +1)
log_top_pmax <- log10(lab.data$top_pmax +1)

log_bipedal_side <- log10(lab.data$bipedal_side +1)
log_bipedal_top <- log10(lab.data$bipedal_top +1)
log_bipedal_percent <- log10(lab.data$bipedal_percent +1)
```


#Writing linear models and Residuals

```{r}
#log.side.amax.biped
log.side.amax.biped <- lm(log_side_amax ~ log_bipedal_side, data = lab.data)
res.log.side.amax.biped <- resid(log.side.amax.biped)
plot(fitted(log.side.amax.biped), res.log.side.amax.biped)

qqnorm(res.log.side.amax.biped)
qqline(res.log.side.amax.biped,
       col = 'red')
shapiro.test(res.log.side.amax.biped)  #normal
plotNormalHistogram(res.log.side.amax.biped)

#log transforming bipedal_side did not appear to change ANYTHING, so I'm just going to run all other runs using log_bipedal

#lmer model
lmer(log_side_amax ~ log_bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
```

```{r}
#Test to see if log transforming bipedal_side does anything -- NO!
#Log transformed side_amax + bipedal_side

log2.side.amax.biped <- lm(log_side_amax ~ bipedal_side, data = lab.data)
res.log2.side.amax.biped <- resid(log2.side.amax.biped)

plot(fitted(log2.side.amax.biped), res.log2.side.amax.biped)
qqnorm(res.log2.side.amax.biped)
qqline(res.log2.side.amax.biped,
       col = 'red')
shapiro.test(res.log2.side.amax.biped)  #normal
plotNormalHistogram(res.log2.side.amax.biped)
```

```{r} 
#log.top.amax.biped
log.top.amax.biped <- lm(log_top_amax ~ log_bipedal_top, data = lab.data)
res.log.top.amax.biped <- resid(log.top.amax.biped)

plot(fitted(log.top.amax.biped), res.log.top.amax.biped)
qqnorm(res.log.top.amax.biped)
qqline(res.log.top.amax.biped,
       col = 'red')
shapiro.test(res.log.top.amax.biped)  #normal
plotNormalHistogram(res.log.top.amax.biped)

#lmer model
lmer(log_top_amax ~ log_bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
```

```{r}
#log.side.vmax.biped
log.side.vmax.biped <- lm(log_side_vmax ~ bipedal_side, data = lab.data)
res.log.side.vmax.biped <- resid(log.side.vmax.biped)

plot(fitted(log.side.vmax.biped), res.log.side.vmax.biped)
qqnorm(res.log.side.vmax.biped)
qqline(res.log.side.vmax.biped,
       col = 'red')
shapiro.test(res.log.side.vmax.biped)  #normal
plotNormalHistogram(res.log.side.vmax.biped)

#lmer model
lmer.log.side.vmax.biped <- lmer(log_side_vmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.vmax.biped)
```

```{r}
#log.top.vmax.biped
log.top.vmax.biped <- lm(log_top_vmax ~ bipedal_top, data = lab.data)
res.log.top.vmax.biped <- resid(log.top.vmax.biped)

plot(fitted(log.top.vmax.biped), res.log.top.vmax.biped)
qqnorm(res.log.top.vmax.biped)
qqline(res.log.top.vmax.biped,
       col = 'red')
shapiro.test(res.log.top.vmax.biped)  #normal
plotNormalHistogram(res.log.top.vmax.biped)

#lmer model
lmer.log.top.vmax.biped <- lmer(log_top_vmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.vmax.biped)
```

```{r}
#log.side.posmax.biped
log.side.posmax.biped <- lm(log_side_posmax ~ bipedal_side, data = lab.data)
res.log.side.posmax.biped <- resid(log.side.posmax.biped)

plot(fitted(log.side.posmax.biped), res.log.side.posmax.biped)
qqnorm(res.log.side.posmax.biped)
qqline(res.log.side.posmax.biped,
       col = 'red')
shapiro.test(res.log.side.posmax.biped)  #normal
plotNormalHistogram(res.log.side.posmax.biped)

#lmer model
lmer.log.side.posmax.biped <- lmer(log_side_posmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.posmax.biped)
```

```{r}
#log.top.posmax.biped
log.top.posmax.biped <- lm(log_top_posmax ~ bipedal_top, data = lab.data)
res.log.top.posmax.biped <- resid(log.top.posmax.biped)

plot(fitted(log.top.posmax.biped), res.log.top.posmax.biped)
qqnorm(res.log.top.posmax.biped)
qqline(res.log.top.posmax.biped,
       col = 'red')
shapiro.test(res.log.top.posmax.biped)  #not normal - skewed right   #really weird data
plotNormalHistogram(res.log.top.posmax.biped)

#lmer model
lmer.log.top.posmax.biped <- lmer(log_top_posmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.posmax.biped)
```

```{r}
#log.side.tmax.biped
log.side.tmax.biped <- lm(log_side_tmax ~ bipedal_side, data = lab.data)
res.log.side.tmax.biped <- resid(log.side.tmax.biped)

plot(fitted(log.side.tmax.biped), res.log.side.tmax.biped)
qqnorm(res.log.side.tmax.biped)
qqline(res.log.side.tmax.biped,
       col = 'red')
shapiro.test(res.log.side.tmax.biped)  #not normal - skewed right
plotNormalHistogram(res.log.side.tmax.biped)

#lmer model
lmer.log.side.tmax.biped <- lmer(log_side_tmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.tmax.biped)
```

```{r}
#log.top.tmax.biped
log.top.tmax.biped <- lm(log_top_tmax ~ bipedal_top, data = lab.data)
res.log.top.tmax.biped <- resid(log.top.tmax.biped)

plot(fitted(log.top.tmax.biped), res.log.top.tmax.biped)
qqnorm(res.log.top.tmax.biped)
qqline(res.log.top.tmax.biped,
       col = 'red')
shapiro.test(res.log.top.tmax.biped)  #not normal - skewed right
plotNormalHistogram(res.log.top.tmax.biped)

#lmer model
lmer.log.top.tmax.biped <- lmer(log_top_tmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.tmax.biped)
```

```{r}
#log.side.pmax.biped
log.side.pmax.biped <- lm(log_side_pmax ~ bipedal_side, data = lab.data)
res.log.side.pmax.biped <- resid(log.side.pmax.biped)

plot(fitted(log.side.pmax.biped), res.log.side.pmax.biped)
qqnorm(res.log.side.pmax.biped)
qqline(res.log.side.pmax.biped,
       col = 'red')
shapiro.test(res.log.side.pmax.biped)  #normal 
plotNormalHistogram(res.log.side.pmax.biped)

#lmer model
lmer.log.side.pmax.biped <- lmer(log_side_pmax ~ bipedal_side + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.side.pmax.biped)
```

```{r}
#log.top.pmax.biped
log.top.pmax.biped <- lm(log_top_pmax ~ bipedal_top, data = lab.data)
res.log.top.pmax.biped <- resid(log.top.pmax.biped)

plot(fitted(log.top.pmax.biped), res.log.top.pmax.biped)
qqnorm(res.log.top.pmax.biped)
qqline(res.log.top.pmax.biped,
       col = 'red')
shapiro.test(res.log.top.pmax.biped)  #normal
plotNormalHistogram(res.log.top.pmax.biped)

#lmer model
lmer.log.top.pmax.biped <- lmer(log_top_pmax ~ bipedal_top + substrate_type + sex + (1 | ID), data = lab.data)
anova(lmer.log.top.pmax.biped)
```


> Glmer and lmer

## lmer is used to fit linear mixed-effect models, so it assumes that the residual error has a Gaussian distribution. If your dependent variable A is a binary outcome (e.g. a yes/no response), then the error distribution is binomial and not Gaussian. In this case you have to use glmer, which allow to fit a generalized linear mixed-effects model: these models include a link function that allows to predict response variables with non-Gaussian distributions.
## glmer -> use when dependent variable (X) is a binary outcome (e.g. yes/no)
### 1 refers to an intercept; means 'add a random intercept for each ID level'


#Lmer models with v/a/biped/p/t vs. substrate type -- Question 2


```{r}
#Velocity
lmer.log.side.vmax.sub <- lmer(log_side_vmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.vmax.sub)

lmer.log.top.vmax.sub <- lmer(log_top_vmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.vmax.sub)
```

```{r}
#Acceleration
lmer.log.side.amax.sub <- lmer(log_side_vmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.amax.sub)

lmer.log.top.amax.sub <- lmer(log_top_vmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.amax.sub)
```

```{r}
#Bipedalism
lmer.log.side.bipedal.sub <- lmer(log_bipedal_side ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.bipedal.sub)

lmer.log.top.bipedal.sub <- lmer(log_bipedal_top ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.bipedal.sub)
```

```{r}
#Power
lmer.log.side.pmax.sub <- lmer(log_side_pmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.pmax.sub)

lmer.log.top.pmax.sub <- lmer(log_top_pmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.pmax.sub)
```

```{r}
#Time
lmer.log.side.tmax.sub <- lmer(log_side_tmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.side.tmax.sub)

lmer.log.top.tmax.sub <- lmer(log_top_pmax ~ substrate_type + (1 | ID), data = lab.data)
anova(lmer.log.top.tmax.sub)
```

















